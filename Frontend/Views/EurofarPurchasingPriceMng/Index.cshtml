@using Frontend.Helper;
@{
    ViewBag.Title = "Eurofar Purchasing Price Management";
    ViewBag.Icon = "fa-search";

    string autoArtCode = string.Empty;
    string autoSeason = string.Empty;
    string autoFactory = string.Empty;
    string autoItemType = "null";
    if (Request.Params.AllKeys.Contains("articleCode"))
    {
        autoArtCode = Request.Params["articleCode"].ToString();
    }
    if (Request.Params.AllKeys.Contains("season"))
    {
        autoSeason = Request.Params["season"].ToString();
    }
    if (Request.Params.AllKeys.Contains("factory"))
    {
        autoFactory = Request.Params["factory"].ToString();
    }
    if (Request.Params.AllKeys.Contains("type") && !string.IsNullOrEmpty(Request.Params["type"].ToString()))
    {
        autoItemType = Request.Params["type"].ToString();
    }
    Frontend.APIDTO.APIUserInformation userInfo = (Frontend.APIDTO.APIUserInformation)ViewBag.CurrentLoginUserInfo;
}

<style>
    select.business-data-options option[value='number:1'], .value-1-select {
        background-color: #ececec;
    }

    select.business-data-options option[value='number:2'], .value-2-select {
        background-color: #ffffab;
    }

    select.business-data-options option[value='number:3'], .value-3-select {
        background-color: #cab1ff;
    }

    select.business-data-options option[value='number:4'], .value-4-select {
        background-color: #bfe7ff;
    }

    .missing-EUR {
        background-color: #fdffa3
    }

    .filter-area input[type=text], .filter-area select {
        width: 80px;
    }
    .filter-area select {
        padding: 2px;
    }
        .filter-area label {
            margin-right: 5px;
        }
    .avs-table-wrapper .avs-table-body table tr td, .avs-table-wrapper .avs-table-header table tr td {
        font-size: 10px;
    }
    .avs-table-wrapper .avs-table-header table tr td {
        line-height: 14px;
    }
</style>

<div class="row">
    <article class="col-sm-12">
        <div class="jarviswidget" id="pnlSearchResult" data-widget-deletebutton="false" data-widget-editbutton="false" data-widget-colorbutton="false" data-widget-togglebutton="false">
            <header>
                <h2 id="sectionTitle">Central Database</h2>
            </header>
            <div class="no-padding">
                <div class="widget-body" id="pnlQuotationRequest" style="display: none;">
                    <div class="form-inline dt-bootstrap no-footer tilsoft-table-wrapper">
                        <div style="padding: 10px; border: solid 1px #ddd; border-bottom: none; box-sizing: border-box; z-index: 101; font-size: 12px;">
                            <div class="row">
                                <div class="col-xs-12 col-sm-6">
                                    <a href="javascript:void(0)" class="btn btn-default" ng-click="event.switchView('pnlCentralData')"><i class="fa fa-exchange"></i> Central Database</a>
                                    <a href="javascript:void(0)" class="btn btn-primary" ng-click="frmQuotationRequestJs.event.reload()"><i class="fa fa-exchange"></i> Search</a>
                                </div>
                            </div>
                        </div>

                        @Html.Partial("~/Views/EurofarPurchasingPriceMng/Index/QuotationRequest.cshtml")
                    </div>
                </div>

                <div class="widget-body" style="padding-bottom: 0px;" id="pnlCentralData">
                    <div class="form-inline dt-bootstrap no-footer tilsoft-table-wrapper">
                        <div style="padding: 10px; border: solid 1px #ddd; border-bottom: none; box-sizing: border-box; z-index: 101; font-size: 12px;">
                            <div class="row">
                                <div class="col-xs-12 col-sm-6">
                                    <a href="javascript:void(0)" class="btn btn-success btn-xs" ng-click="event.updateTarget()"><i class="fa fa-save"></i> Update Price</a>
                                    <a href="javascript:void(0)" class="btn btn-primary btn-xs" ng-click="event.confirmPrice()"><i class="fa fa-thumbs-o-up"></i> Confirm</a>
                                    <a href="javascript:void(0)" class="btn btn-warning btn-xs" ng-click="event.unConfirmPrice()"><i class="fa fa-thumbs-o-down"></i> Un-Confirm</a>
                                    <a href="javascript:void(0)" class="btn btn-default btn-xs" onclick="$('#pnlWaitForFactory').show()"><i class="fa fa-info"></i> Wait For Factory Conclusion</a>
                                    <a href="javascript:void(0)" class="btn btn-default btn-xs" ng-click="event.switchView('pnlQuotationRequest')"><i class="fa fa-exchange"></i> Quotation Request</a>
                                    <a href="javascript:void(0)" class="btn btn-success btn-xs" ng-click="event.exportExcel()"><i class="fa fa-file-excel-o"></i> Export</a>
                                    <a href="javascript:void(0)" class="btn btn-success btn-xs" ng-click="importFromExcel.importExcel()"><i class="fa fa-file-excel-o"></i> Import</a>
                                </div>

                                <div ng-if="data.status.isLoaded">
                                    <div class="col-xs-12 col-sm-6" style="text-align: right;">
                                        <strong>Items</strong>&nbsp;
                                        <span class="label label-default">Total: {{data.status.total | number}}</span>
                                        <span class="label label-success">Confirmed: {{data.status.confirmed | number}}</span>
                                        <span class="label label-warning">Pending: {{data.status.pending | number}}</span>
                                        (
                                        <span class="label label-default" style="background: #afdc7e; color: #000 !important;">Eurofar: {{data.status.waitEurofar | number}}</span>
                                        <span class="label label-default" style="background: #ffe699; color: #000 !important;">Factory: {{data.status.waitFactory | number}}</span>
                                        <span class="label label-default" style="background: #a65858; color: #fff !important;">Estimated: {{data.status.estimated | number}}</span>
                                        )

                                        <br />

                                        <strong>Containers</strong>&nbsp;
                                        <span class="label label-default">Total: {{data.status.totalContainer | number:1}}</span>
                                        <span class="label label-success">Confirmed: {{data.status.totalConfirmedContainer | number:1}}</span>
                                        <span class="label label-warning">Pending: {{data.status.totalPendingContainer | number:1}}</span>
                                        (
                                        <span class="label label-default" style="background: #afdc7e; color: #000 !important;">Eurofar: {{data.status.totalContainerWaitForEurofar | number:1}}</span>
                                        <span class="label label-default" style="background: #ffe699; color: #000 !important;">Factory: {{data.status.totalContainerWaitForFactory | number:1}}</span>
                                        <span class="label label-default" style="background: #a65858; color: #fff !important;">Estimated: {{data.status.totalContainerEstimated | number:1}}</span>
                                        )
                                    </div>
                                </div>
                                <div ng-if="data.status.isLoaded === false" class="data-loading">loading...</div>
                            </div>

                            <div id="pnlWaitForFactory" class="row" style="display: none;">
                                <div class="col-xs-6 col-sm-12">
                                    <h3>Wait for factory conclusion <a href="javascript:void(0)" class="btn btn-default btn-xs" onclick="$('#pnlWaitForFactory').hide()">Close</a></h3>
                                </div>                                
                                <div class="col-xs-6 col-sm-6">
                                    <table class="table table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th colspan="9" style="text-align: center;">OFFER ITEM</th>
                                            </tr>
                                            <tr>
                                                <th rowspan="2" style="width: 80px; vertical-align: middle; text-align: center;">({{data.status.waitForFactoryConlusion.length}})</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">FACTORY</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">P.I.C</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">PENDING</th>
                                                <th colspan="5" style="vertical-align: middle; text-align: center;">OVERDUE</th>
                                            </tr>
                                            <tr>
                                                <th style="vertical-align: middle; text-align: center;">TOTAL</th>
                                                <th style="vertical-align: middle; text-align: center;">1 day</th>
                                                <th style="vertical-align: middle; text-align: center;">2 day</th>
                                                <th style="vertical-align: middle; text-align: center;">3 day</th>
                                                <th style="vertical-align: middle; text-align: center;">4 day or more</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td colspan="3">&nbsp;</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.totalPendingItem | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.totalItem | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.overDue1Day | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.overDue2Day | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.overDue3Day | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryConlusionSummary.overDue4DayOrMore | number}}</td>
                                            </tr>
                                            <tr ng-repeat="item in data.status.waitForFactoryConlusion">
                                                <td style="text-align: center;"><a href="mailto:{{$parent.event.getEmailAddresses(item.factoryID)}}&subject=Eurofar is waiting for your price response for offer item, season {{$parent.controls.grdSearchResult.filters.Season}}&body=Waiting for offer from factory: {{item.factoryUD}}%0D%0ATotal pending: {{item.totalPendingItem}}%0D%0A1 day overdue:{{item.overDue1Day}}%0D%0A2 days overdue:{{item.overDue2Day}}%0D%0A3 days overdue: {{item.overDue3Day}}%0D%0A4 days or more overdue:{{item.overDue4DayOrMore}}%0D%0APlease follow this link to see the list of overdue items: http%3A%2F%2Fapp.tilsoft.bg%2FFactoryQuotation2Mng%2FIndex%3Fseason%3D{{controls.grdSearchResult.filters.Season}}%26overdue%3D1%0D%0AFor pending items: http%3A%2F%2Fapp.tilsoft.bg%2FFactoryQuotation2Mng%2FIndex%3Fstatus%3D1%26wait%3D2%26type%3D5" class="btn btn-default btn-sm">Send email</a></td>
                                                <td style="text-align: center;">{{item.factoryUD}}</td>
                                                <td style="text-align: center;">
                                                    <a ng-if="item.pricingTeamMemberID" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{item.pricingTeamMemberID}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                                        {{item.pricingTeamMemberNM}}
                                                    </a>
                                                </td>
                                                <td style="text-align: right;">{{item.totalPendingItem | number}}</td>
                                                <td style="text-align: right;">{{item.totalItem | number}}</td>
                                                <td style="text-align: right;">{{item.overDue1Day | number}}</td>
                                                <td style="text-align: right;">{{item.overDue2Day | number}}</td>
                                                <td style="text-align: right;">{{item.overDue3Day | number}}</td>
                                                <td style="text-align: right;">{{item.overDue4DayOrMore | number}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-xs-6 col-sm-6">
                                    <table class="table table-striped table-bordered">
                                        <thead>
                                            <tr>
                                                <th colspan="10" style="text-align: center;">PRODUCTION ITEM</th>
                                            </tr>
                                            <tr>
                                                <th rowspan="2" style="width: 80px; vertical-align: middle; text-align: center;">({{data.status.waitForFactoryProductionConlusion.length}})</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">FACTORY</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">P.I.C</th>
                                                <th rowspan="2" style="vertical-align: middle; text-align: center;">PENDING</th>
                                                <th colspan="6" style="vertical-align: middle; text-align: center;">DAYS TILL LDS</th>
                                            </tr>
                                            <tr>
                                                <th style="vertical-align: middle; text-align: center;">Over LDS</th>
                                                <th style="vertical-align: middle; text-align: center;">LDS</th>
                                                <th style="vertical-align: middle; text-align: center;">1-2 days</th>
                                                <th style="vertical-align: middle; text-align: center;">3-4 days</th>
                                                <th style="vertical-align: middle; text-align: center;">5-6 days</th>
                                                <th style="vertical-align: middle; text-align: center;">7 days or more</th>
                                            </tr>
                                        </thead>    
                                        <tbody>
                                            <tr>
                                                <td colspan="3">&nbsp;</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.totalPendingItem | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.overLDS | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.lds | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.oneToTwoDays | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.threeToFourDays | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.fiveToSixDays | number}}</td>
                                                <td style="text-align: right; font-weight: bold;">{{data.status.waitForFactoryProductionConlusionSummary.moreThanSixDays | number}}</td>
                                            </tr>
                                            <tr ng-repeat="item in data.status.waitForFactoryProductionConlusion">
                                                <td style="text-align: center;"><a href="mailto:{{$parent.event.getEmailAddresses(item.factoryID)}}&subject=Eurofar is waiting for your price response for production item, season {{$parent.controls.grdSearchResult.filters.Season}}&body=Waiting for offer from factory: {{item.factoryUD}}%0D%0ATotal pending: {{item.totalPendingItem}}%0D%0AOver LDS:{{item.overLDS}}%0D%0ALDS:{{item.lds}}%0D%0A1-2 days to LDS: {{item.oneToTwoDays}}%0D%0A3-4 days to LDS:{{item.threeToFourDays}}%0D%0A5-6 days to LDS:{{item.fiveToSixDays}}%0D%0A6 days or more to LDS:{{item.moreThanSixDays}}%0D%0APlease follow this link to see the list of pending items: http%3A%2F%2Fapp.tilsoft.bg%2FFactoryQuotation2Mng%2FIndex%3Fstatus%3D1%26wait%3D2%26type%3D1" class="btn btn-default btn-sm">Send email</a></td>
                                                <td style="text-align: center;">{{item.factoryUD}}</td>
                                                <td style="text-align: center;">
                                                    <a ng-if="item.pricingTeamMemberID" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{item.pricingTeamMemberID}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                                        {{item.pricingTeamMemberNM}}
                                                    </a>
                                                </td>
                                                <td style="text-align: right;">{{item.totalPendingItem | number}}</td>
                                                <td style="text-align: right;">{{item.overLDS | number}}</td>
                                                <td style="text-align: right;">{{item.lds | number}}</td>
                                                <td style="text-align: right;">{{item.oneToTwoDays | number}}</td>
                                                <td style="text-align: right;">{{item.threeToFourDays | number}}</td>
                                                <td style="text-align: right;">{{item.fiveToSixDays | number}}</td>
                                                <td style="text-align: right;">{{item.moreThanSixDays | number}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="row filter-area" style="margin-top: 5px;">
                                <div class="col-xs-12 col-sm-12">
                                    <label>
                                        Season
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.Season" ng-options="item.seasonValue as item.seasonText for item in data.seasons"></select>
                                    </label>

                                    <label>
                                        P/I
                                        <input class="search-filter" type="text" ng-model="controls.grdSearchResult.filters.ProformaInvoiceNo" />
                                    </label>

                                    <label>
                                        Client
                                        <input class="search-filter" type="text" ng-model="controls.grdSearchResult.filters.ClientNM" />
                                    </label>

                                    <label>
                                        Type
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.ItemTypeID" ng-options="item.id as item.name for item in data.itemTypes">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        Description
                                        <input class="search-filter" type="text" ng-model="controls.grdSearchResult.filters.Description" />
                                    </label>

                                    <label>
                                        Factory
                                        <input class="search-filter" type="text" ng-model="controls.grdSearchResult.filters.FactoryUD" />
                                    </label>

                                    <label>
                                        Status
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.StatusID" ng-options="item.quotationStatusID as item.quotationStatusNM for item in data.quotationStatuses">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        Wait Status
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.QuotationOfferDirectionID" ng-options="item.id as item.name for item in data.waitStatuses">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        Order Type
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.OrderTypeID" ng-options="item.orderTypeID as item.orderTypeNM for item in data.orderTypes">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        <font class="value-{{controls.grdSearchResult.filters.BusinessDataStatusID}}-select">Business data status</font>
                                        <select class="search-filter business-data-options" ng-model="controls.grdSearchResult.filters.BusinessDataStatusID" ng-options="item.id as item.name for item in data.businessDataStatuses">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        Shipped status
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.ShippedStatus" ng-options="item.id as item.name for item in data.shippedStatuses">
                                            <option></option>
                                        </select>
                                    </label>

                                    <label>
                                        LDS from
                                        <input class="search-filter datepicker" type="text" data-dateformat="dd/mm/yy" ng-model="controls.grdSearchResult.filters.LDSFrom" />
                                    </label>

                                    <label>
                                        LDS to
                                        <input class="search-filter datepicker" type="text" data-dateformat="dd/mm/yy" ng-model="controls.grdSearchResult.filters.LDSTo" />
                                    </label>

                                    <label>
                                        Catalog Page
                                        <input class="search-filter" type="text" ng-model="controls.grdSearchResult.filters.CataloguePageNo" />
                                    </label>

                                    <label>
                                        Price Team Member
                                        <select class="search-filter" ng-model="controls.grdSearchResult.filters.PricingTeamMemberID" ng-options="person.userID as person.employeeNM for person in data.pricingTeamMemberInChargeDTOs">
                                            <option></option>
                                        </select>
                                    </label>

                                    <a href="javascript:void(0)" class="btn btn-primary btn-xs" title="Apply Filter" ng-click="controls.grdSearchResult.event.reload()"><i class="fa fa-filter"></i> Apply Filter</a>
                                    <a href="javascript:void(0)" class="btn btn-default btn-xs" title="Clear Filter" ng-click="controls.grdSearchResult.event.clearFilter()"><i class="fa fa-ban"></i> Clear Filter</a>
                                </div>
                            </div>

                            <div class="row" style="margin-top: 5px;" ng-if="data.selectedRow.newTargetComment">
                                <div class="col-xs-12 col-sm-12">
                                    <table style="width: 100%;">
                                        <tr>
                                            <td>New&nbsp;Comment</td>
                                            <td>&nbsp;</td>
                                            <td style="width: 100%;"><input type="text" style="width: 100%; box-sizing: border-box;" ng-model="data.selectedRow.newTargetComment" /></td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div class="avs-table-wrapper" avs-table grid-handler="gridHandler">
                            <div class="avs-table-header">
                                <div class="avs-table-header-container">
                                    <table>
                                        <tr class="header-row" style="height: 50px;">
                                            <td style="width: 65px;"><strong>Found</strong>: {{controls.grdSearchResult.status.totalRows | number}}</td>
                                            <td style="width: 30px;"><label><input type="checkbox" ng-model="data.isSelectAll" ng-change="event.toggleSelectAll()" /></label></td>
                                            <td style="width: 40px;">Sea son</td>
                                            <td style="width: 60px;" class="sorting" data-colname="ProformaInvoiceNo">P/I</td>
                                            <td style="width: 80px;" class="sorting" data-colname="ClientNM">Client</td>
                                            <td style="width: 40px;" class="sorting" data-colname="CataloguePageNo">Ty pe</td>
                                            <td style="width: 60px;">Image</td>
                                            <td style="width: 500px;">Description</td>
                                            <td style="width: 55px;" class="sorting" data-colname="OrderQnt">Qnt</td>
                                            <td style="width: 60px;">Cum Qnt</td>
                                            <td style="width: 40px;" class="sorting" data-colname="TotalShippedQnt">Shipp ed</td>
                                            <td style="width: 40px;" class="sorting" data-colname="Qnt40HC">Qnt / 40HC</td>
                                            <td style="width: 55px;" class="sorting" data-colname="OrderQnt40HC">40HC Qnt</td>
                                            <td style="width: 70px;" class="sorting" data-colname="FactoryUD">Fac tory</td>
                                            <td style="width: 50px;" class="sorting" data-colname="ShippedByFactoryUD">Sub Fac tory</td>
                                            <td style="width: 60px;" class="sorting" data-colname="LDS">LDS</td>
                                            <td style="width: 60px;" class="sorting" data-colname="LDS">Soon est ship date</td>
                                            <td style="width: 60px">Sta tus</td>
                                            <td style="width: 55px;">Conf Price</td>
                                            <td style="width: 65px;">% Delta 6</td>
                                            <td style="width: 65px; color: #d49922;" title="Price Offer History from Factory">Factory Price 1</td>
                                            <td style="width: 65px; color: #261db7;" title="Price Offer History from Eurofar">Target Price 1</td>
                                            <td style="width: 65px; color: #d49922;" title="Price Offer History from Factory">Factory Price 2</td>
                                            <td style="width: 65px; color: #261db7;" title="Price Offer History from Eurofar">Target Price 2</td>
                                            <td style="width: 65px; color: #d49922;" title="Price Offer History from Factory (latest offer - always equal to Factory price)">Factory Price 3</td>
                                            <td style="width: 65px; color: #261db7;" title="Price Offer History from Eurofar (latest offer - always equal to Target price)">Target Price 3</td>
                                            <td style="width: 55px;" title="Current Price including the '% Quality' (this is the actual price which Eurofar has to pay)">Fac tory Price</td>
                                            <td style="width: 55px;">Sale Price</td>
                                            <td style="width: 55px;">Break down (AVF / AVT)</td>
                                            <td style="width: 55px;" title="Current Target Price Offer from Eurofar">Tar get Price</td>
                                            <td style="width: 70px" title="Put in your new target offer, the box will be disabled if price is already confirmed">New Target</td>
                                            <td style="width: 70px" title="Put in your comment for new target offer, the box will be disabled if price is already confirmed">New Comment</td>
                                            <td style="width: 55px">Re mark</td>
                                            <td style="width: 90px">Sale Amount (&euro;)</td>
                                            <td style="width: 90px">Sale Amount ($)</td>
                                            <td style="width: 90px">Sale Amount (Conv to $)</td>
                                            <td style="width: 90px">Pur Amount ($)</td>
                                            <td style="width: 90px">Comm ($)</td>
                                            <td style="width: 90px">Bonus ($)</td>
                                            <td style="width: 90px">Trans ($)</td>
                                            <td style="width: 90px">LC ($)</td>
                                            <td style="width: 90px">Interest ($)</td>
                                            <td style="width: 90px">Damage ($)</td>
                                            <td style="width: 90px">Delta 6 ($)</td>
                                        </tr>
                                        @if (userInfo.Data.ModuleSpecialPermissionAccesses.Count(o => o.ModuleSpecialPermissionUD == Frontend.Helper.ConstantIdentifier.SPECIAL_PERMISSION_SEE_ALL_PURCHASING_DATA) > 0)
                                        {
                                        <tr class="total-row">
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.totalOrderQnt | number) : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.totalOrderQnt40HC | number:1) : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? ((controls.grdSearchResult.totalRow.purchasingAmountUSD ? controls.grdSearchResult.totalRow.delta6Amount * 100 / controls.grdSearchResult.totalRow.purchasingAmountUSD : null) | number:1) + (controls.grdSearchResult.totalRow.purchasingAmountUSD ? '%' : '') : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.saleAmountEUR | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.saleAmountUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.saleAmountConvertedUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.purchasingAmountUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.commissionUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.bonusUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.transportationUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.lcCostUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.interestUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.damageUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.totalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.totalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.totalRow.delta6Amount | number:1) : 'loading...'}}</td>
                                        </tr>
                                        <tr class="total-row">
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.totalOrderQnt | number) : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.totalOrderQnt40HC | number:1) : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? ((controls.grdSearchResult.subTotalRow.purchasingAmountUSD ? controls.grdSearchResult.subTotalRow.delta6Amount * 100 / controls.grdSearchResult.subTotalRow.purchasingAmountUSD : null) | number:1) + (controls.grdSearchResult.subTotalRow.purchasingAmountUSD ? '%' : '') : 'loading...'}}</td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.saleAmountEUR | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.saleAmountUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.saleAmountConvertedUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.purchasingAmountUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.commissionUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.bonusUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.transportationUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.lcCostUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.interestUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.damageUSD | number:1) : 'loading...'}}</td>
                                            <td ng-class="{'data-loading' : controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded === false}">{{controls.grdSearchResult.subTotalRow.isAdditionalDataLoaded ? (controls.grdSearchResult.subTotalRow.delta6Amount | number:1) : 'loading...'}}</td>
                                        </tr>
                                        }
                                    </table>
                                </div>
                            </div>
                            <div class="avs-table-body">
                                <table>
                                    <tr ng-repeat="item in controls.grdSearchResult.data" style="background-color: {{controls.grdSearchResult.method.getRowBackgroundColor(item)}};">
                                        <td>
                                            @if (Frontend.Helper.AuthHelper.GetActionButtonStatus("ProductOverviewRpt", Frontend.Helper.ActionEnum.Read, HttpContext.Current) != "disabled")
                                            {
                                                <a ng-if="item.factoryOrderDetailID" href="@Url.Action("PriceCompare", "ProductOverviewRpt", new { id = UrlParameter.Optional })/{{item.factoryOrderDetailID}}" target="_blank" class="btn btn-default btn-xs" title="Compare"><i class="fa fa-exchange"></i></a>
                                                <a ng-if="item.offerSeasonDetailID && item.factoryOrderDetailID === null && item.itemTypeID === 5" href="@Url.Action("PriceCompare", "ProductOverviewRpt", new { id = UrlParameter.Optional })/0?oID={{item.offerSeasonDetailID}}" target="_blank" class="btn btn-default btn-xs" title="Compare"><i class="fa fa-exchange"></i></a>
                                            }
                                            <a target="_blank" ng-if="item.offerSeasonDetailID" href="@Url.Action("Edit", "BreakDownMng", new { id = UrlParameter.Optional })/0?modelId=0&sampleProductId=0&offerSeasonDetailId={{item.offerSeasonDetailID}}&factoryId={{item.factoryID}}" class="btn btn-primary btn-xs" title="Breakdown"><i class="fa fa-cubes"></i></a>
                                            <span style="display: block;">{{item.quotationDetailID}}</span>
                                        </td>
                                        <td><label><input ng-if="item.unConfirmable && item.statusID !== 5" type="checkbox" ng-model="item.isSelected" /></label></td>
                                        <td>{{event.seasonShortCut(item.season)}}</td>
                                        <td>
                                            <div ng-if="item.saleOrderID" style="color: #6bb020;">
                                                @if (Frontend.Helper.AuthHelper.GetActionButtonStatus("SaleOrderMng", Frontend.Helper.ActionEnum.Read, HttpContext.Current) != "disabled")
                                                {
                                                    <a style="color: #6bb020;" href="@Url.Action("Overview", "SaleOrder", new { id = UrlParameter.Optional })/{{item.saleOrderID}}/0" target="_blank">{{item.proformaInvoiceNo}}</a>
                                                }
                                                else
                                                {
                                                    <text>{{item.proformaInvoiceNo}}</text>
                                                }
                                                <span ng-if="item.orderTypeNM" style="display: block; text-align: center; font-size: 9px;">({{item.orderTypeNM}})</span>
                                            </div>
                                            <div ng-if="!item.saleOrderID && item.offerSeasonID" style="color: blueviolet;">
                                                @if (Frontend.Helper.AuthHelper.GetActionButtonStatus("OfferSeasonMng", Frontend.Helper.ActionEnum.Update, HttpContext.Current) != "disabled")
                                                {
                                                    <a style="color: blueviolet;" href="@Url.Action("Edit", "OfferSeasonMng", new { id = UrlParameter.Optional })/{{item.offerSeasonID}}#/edit-fob-product-form" target="_blank">{{item.offerSeasonUD}}</a>
                                                }
                                                else
                                                {
                                                    <text>{{item.offerSeasonUD}}</text>
                                                }
                                            </div>
                                        </td>
                                        <td>
                                            <a href="@Url.Action("Overview", "Client")/{{item.clientID}}" target="_blank">{{item.clientUD}}</a>
                                            <br />
                                            {{item.clientNM}}
                                            <br />
                                            <a href="javascript:void(0)" ng-show="item.additionalCondition!=null" data-toggle="modal" ng-click="event.openAdditional(item.additionalCondition)">Addition Condition</a>
                                        </td>
                                        <td style="text-align: center;">
                                            {{item.itemTypeID === 1 ? 'F/O PRODUCT' : ''}}
                                            {{item.itemTypeID === 0 ? 'F/O SPAREPART' : ''}}
                                            {{item.itemTypeID === 6 ? 'F/O SAMPLE' : ''}}
                                            {{item.itemTypeID === 5 ? 'OFFER ITEM' : ''}}
                                            {{item.itemTypeID === 2 ? 'OFFER SAMPLE' : ''}}
                                            {{item.itemTypeID === 7 ? 'OFFER ITEM (Estimated)' : ''}}
                                            {{item.itemTypeID === 3 ? 'CATALOGUE ITEM' : ''}}
                                            {{item.itemTypeID === 4 ? 'REQUESTED ITEM' : ''}}

                                            <span style="display: block; text-decoration: underline;" ng-if="item.itemTypeID === 3 && item.cataloguePageNo">Page: {{item.cataloguePageNo}}</span>
                                        </td>
                                        <td>
                                            <a href="{{item.fileLocation}}" data-featherlight="image">
                                                <img style="width: 95%;" ng-src="{{item.thumbnailLocation}}" />
                                            </a>
                                        </td>
                                        <td>
                                            <a href="@Url.Action("Edit", "Model")/{{item.modelID}}" target="_blank" ng-show="item.modelID">{{item.articleCode}}</a>
                                            <strong ng-show="!item.modelID">{{item.articleCode}}</strong>
                                            <br />
                                            {{item.description}}
                                            <br />
                                            <strong>Packaging: </strong> {{item.packagingMethodNM}}
                                        </td>
                                        <td style="text-align: right;">{{item.orderQnt | number}}</td>
                                        <td style="text-align: right;">
                                            <span title="Same Art Code & Client & Factory">{{item.sumOrderQnt1 | number}} </span>
                                            <hr style="border-width: 2px; margin: 5px 0px;" />
                                            <span title="Same Art Code & Factory">{{item.sumOrderQnt2 | number}}</span>
                                            <hr style="border-width: 2px; margin: 5px 0px;" />
                                            <span title="Same Model & Factory">{{item.sumOrderQnt3 | number}} </span>
                                        </td>
                                        <td style="text-align: right;">{{item.totalShippedQnt | number}}</td>
                                        <td style="text-align: right;">{{item.qnt40HC | number}}</td>
                                        <td style="text-align: right;">{{item.orderQnt40HC | number:1}}</td>
                                        <td style="text-align: center;">
                                            <a href="@Url.Action("Edit", "FactoryMng2")/{{item.factoryID}}" target="_blank">{{item.factoryUD}}</a>
                                            <hr style="border-width: 2px; margin: 5px 0px;" />
                                            <a ng-if="item.pricingTeamMemberID" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{item.pricingTeamMemberID}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                                {{item.pricingTeamMemberNM}}
                                            </a>
                                        </td>
                                        <td>
                                            <a href="@Url.Action("Edit", "FactoryMng2")/{{item.shippedByFactoryID}}" target="_blank">{{item.shippedByFactoryUD}}</a>
                                        </td>
                                        <td>{{item.lds}}</td>
                                        <td>{{item.soonestShippedDate}}</td>
                                        <td style="text-align: center; background-color: {{item.statusID === 5 ? '#a65858' : (item.quotationOfferDirectionID === 1 ? '#afdc7e' : (item.quotationOfferDirectionID === 2 ? '#ffe699' : ''))}};">
                                            <strong>{{item.quotationStatusNM}}</strong>
                                            <span style="display: block; text-align: center;">{{item.quotationOfferDirectionID === 1 ? 'WAIT EUROFAR' : (item.quotationOfferDirectionID === 2 ? 'WAIT FACTORY' : '')}}</span>
                                            <a ng-if="item.statusUpdatedBy && (item.statusID === 5 || item.statusID === 3)" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{item.statusUpdatedBy}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                                {{item.statusUpdatorName}}
                                            </a>
                                        </td>
                                        <td style="text-align: right;">
                                            {{item.statusID === 3 ? item.purchasingPriceIncludeDiff : null | currency:'$':2}}
                                        </td>
                                        <td style="text-align: right;">{{item.purchasingAmountUSD ? item.delta6Amount * 100 / item.purchasingAmountUSD : null | number:1}}{{item.purchasingAmountUSD ? '%' : ''}}</td>
                                        <td style="text-align: right;">{{item.factoryPrice1  | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.furnindoPrice1  | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.factoryPrice2  | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.furnindoPrice2  | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.factoryPrice3  | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.furnindoPrice3  | currency:'$':2}}</td>
                                        <td style="text-align: right;">
                                            <a ng-if="item.itemTypeID !== 7" href="javascript:void(0)" ng-click="event.openHistory(item)" style="color: #6bb020;">{{item.purchasingPriceIncludeDiff | currency:'$':2}}</a>
                                            <span ng-if="item.itemTypeID === 7">{{item.purchasingPriceIncludeDiff | currency:'$':2}}</span>
                                        </td>
                                        <td style="text-align: right;">{{item.salePrice  | currency:(item.currency === 'USD' ? '$' : '&euro;'):2}}</td>
                                        <td style="text-align: right;">[Breakdown]</td>
                                        <td style="text-align: right;">
                                            <a ng-if="item.itemTypeID !== 7" href="javascript:void(0)" ng-click="event.openHistory(item)">{{item.targetPrice | currency:'$':2}}</a>
                                            <span ng-if="item.itemTypeID === 7">{{item.targetPrice | currency:'$':2}}</span>
                                        </td>
                                        <td style="text-align: right;">
                                            <input ng-if="item.statusID !== 3" type="text" avs-currency-2 ng-model="item.newTargetPrice" style="text-align: right;" ng-focus="data.selectedRow = item" />
                                        </td>
                                        <td>
                                            <input ng-if="item.statusID !== 3" type="text" ng-model="item.newTargetComment" ng-focus="data.selectedRow = item" />
                                        </td>
                                        <td>{{item.remark}}</td>
                                        <td style="text-align: right;">{{item.saleAmountEUR | currency:'&euro;':2}}</td>
                                        <td style="text-align: right;">{{item.saleAmountUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.saleAmountConvertedUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.purchasingAmountUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.commissionUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.bonusUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.transportationUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.lcCostUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.interestUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.damageUSD | currency:'$':2}}</td>
                                        <td style="text-align: right;">{{item.delta6Amount | currency:'$':2}}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>
</div>

<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="frmHistory" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin-top:90px !important">
            <div class="modal-header">
                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                    ×
                </button>
                <h4 class="modal-title">Offer History</h4>
            </div>
            <div class="modal-body smart-form" style="padding: 0px;">
                <div>
                    <div class="widget-body">
                        <table class="table table-bordered table-striped" style="box-sizing: border-box;">
                            <thead>
                                <tr>
                                    <th>Offer Direction</th>
                                    <th>Price</th>
                                    <th>Remark</th>
                                    <th>Updated By</th>
                                    <th>Updated Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in data.historyData">
                                    <td>{{item.quotationOfferDirectionNM}}</td>
                                    <td style="text-align: right;">{{item.price | currency:'$':2}}</td>
                                    <td>{{item.remark}}</td>
                                    <td>
                                        <a ng-if="item.userID" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{item.userID}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                            {{item.updatorNM}}
                                        </a>
                                    </td>
                                    <td>{{item.updatedDate}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="frmPurchaseHistory" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin-top:90px !important">
            <div class="modal-header">
                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                    ×
                </button>
                <h4 class="modal-title">Purchasing Price History</h4>
            </div>
            <div class="modal-body smart-form" style="padding: 0px;">
                <div>
                    <div class="widget-body">
                        <table class="table table-bordered table-striped" style="box-sizing: border-box;">
                            <thead>
                                <tr>
                                    <th>Season</th>
                                    <th>P/I</th>
                                    <th>Client</th>
                                    <th>Description</th>
                                    <th>Factory</th>
                                    <th>Purchasing Price</th>
                                    <th>Order Qnt</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in data.purchaseHistoryData">
                                    <td>{{item.season}}</td>
                                    <td>{{item.proformaInvoiceNo}}</td>
                                    <td>
                                        <strong>{{item.clientUD}}</strong>
                                        <br />
                                        {{item.clientNM}}
                                    </td>
                                    <td>
                                        <strong>{{item.articleCode}}</strong>
                                        <br />
                                        {{item.description}}
                                    </td>
                                    <td>{{item.factoryUD}}</td>
                                    <td style="text-align: right;">{{item.purchasingPrice | currency:'$':2}}</td>
                                    <td style="text-align: right;">{{item.orderQnt | number}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="frmGeneralBreakDown" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin-top:90px !important">
            <div class="modal-header">
                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                    ×
                </button>
                <h4 class="modal-title">General BreakDown</h4>
            </div>
            <div class="modal-body smart-form" style="padding: 0px;">
                <div>
                    <div class="widget-body">
                        <table class="table table-bordered table-striped" style="box-sizing: border-box;">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Size</th>
                                    <th>Frame</th>
                                    <th>Cushion</th>
                                    <th>Carton</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in data.generalBreakDownData">
                                    <td>
                                        @if (Frontend.Helper.AuthHelper.GetActionButtonStatus("ProductBreakDownMng", Frontend.Helper.ActionEnum.Read, HttpContext.Current) != "disabled")
                                        {
                                            <a href="@Url.Action("Edit", "ProductBreakDownMng", new { id = UrlParameter.Optional })/{{item.productBreakDownID}}" target="_blank">
                                                <strong>{{item.modelUD}}</strong>
                                                <br />
                                                {{item.modelNM}}
                                            </a>
                                        }
                                        else
                                        {
                                            <text>
                                                <strong>{{item.modelUD}}</strong>
                                                <br />
                                                {{item.modelNM}}
                                            </text>
                                        }
                                    </td>
                                    <td>{{item.itemSize}}</td>
                                    <td>{{item.frameDescription}}</td>
                                    <td>{{item.cushionDescription}}</td>
                                    <td>{{item.cartonSize}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>

<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="frmPALBreakDown" class="modal fade">
    <div class="modal-dialog modal-lg">
        <div class="modal-content" style="margin-top:90px !important">
            <div class="modal-header">
                <button aria-hidden="true" data-dismiss="modal" class="close" type="button">
                    ×
                </button>
                <h4 class="modal-title">PAL BreakDown</h4>
            </div>
            <div class="modal-body smart-form" style="padding: 0px;">
                <div>
                    <div class="widget-body">
                        <table class="table table-bordered table-striped" style="box-sizing: border-box;">
                            <thead>
                                <tr>
                                    <th>Model</th>
                                    <th>Size</th>
                                    <th>Frame</th>
                                    <th>Cushion</th>
                                    <th>Carton</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr ng-repeat="item in data.palBreakDownData">
                                    <td>
                                        @if (Frontend.Helper.AuthHelper.GetActionButtonStatus("ProductBreakDownPALMng", Frontend.Helper.ActionEnum.Read, HttpContext.Current) != "disabled")
                                        {
                                            <a href="@Url.Action("Edit", "ProductBreakDownPALMng", new { id = UrlParameter.Optional })/{{item.productBreakDownID}}" target="_blank">
                                                <strong>{{item.modelUD}}</strong>
                                                <br />
                                                {{item.modelNM}}
                                            </a>
                                        }
                                        else
                                        {
                                            <text>
                                                <strong>{{item.modelUD}}</strong>
                                                <br />
                                                {{item.modelNM}}
                                            </text>
                                        }
                                    </td>
                                    <td>{{item.itemSize}}</td>
                                    <td>{{item.frameDescription}}</td>
                                    <td>{{item.cushionDescription}}</td>
                                    <td>{{item.cartonSize}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="frmAdditionCondition" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Additional Condition</h4>
            </div>
            <div class="modal-body">
                <p>
                    {{additional}}
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">
                    Close
                </button>
            </div>
        </div>
    </div>
</div>


@section FormAction {
    <ul id="sparks">
        <li>
            <a href="javascript:void(0)" class="btn btn-default" title="Search" ng-click="event.reload()"><i class="fa fa-refresh"></i></a>
        </li>
        <li>
            <a href="javascript:void(0)" class="btn btn-default " title="Export excel" ng-click="event.exportExcel()"><i class="fa fa-file-excel-o"></i></a>
        </li>
    </ul>
}

@section pagejs {
    <script type="text/javascript">
        var context = {
            serviceUrl: '@(System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"])api/eurofar-purchasing-price-mng/',
            token : '@Session[Frontend.Customize.Common.ProjectDefinition.TOKEN_SESSION]',
            pageSize: 20,
            autoArtCode: '@autoArtCode',
            autoSeason: '@autoSeason',
            autoFactory: '@autoFactory',
            autoItemType: @autoItemType,
            backendReportUrl: '@System.Configuration.ConfigurationManager.AppSettings["BackendReportUrl"]',
            serviceQuotationRequestUrl: '@(System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"])api/offer-season-quotation-request/'
        }
    </script>
    <script src="~/Views/EurofarPurchasingPriceMng/index.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/jsonService2.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Views/EurofarPurchasingPriceMng/Index/quotationRequest.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Views/EurofarPurchasingPriceMng/service.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
}
