@{
    ViewBag.Title = "Account Payable Report";
    ViewBag.Module = "Account Payable Report";
    ViewBag.Icon = "fa-bar-chart-o";

    var guid = Guid.NewGuid().ToString().Replace("-", "");
    var serviceRoot = System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"];
    var token = Session[Frontend.Customize.Common.ProjectDefinition.TOKEN_SESSION];
    var pageSize = System.Configuration.ConfigurationManager.AppSettings["DefaultPageSize"];
    var backendReportUrl = System.Configuration.ConfigurationManager.AppSettings["BackendReportUrl"];
    var supportServiceRoot = System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"];

    string userManualUrl = string.Empty;
    if (System.IO.File.Exists(Server.MapPath("~/UserManual/" + ViewBag.ModuleCode + ".pdf")))
    {
        userManualUrl = "/UserManual/" + ViewBag.ModuleCode + ".pdf";
    }

}

<div class="row" name="indexForm">
    <article class="col col-sm-12">
        <div class="jarviswidget" data-widget-editbutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false">
            <header>
                <span class="widget-icon">
                    <i class="fa fa-search"></i>
                </span>
                <h2>Search filters</h2>
            </header>
            <div class="no-padding">
                <div class="widget-body">
                    <div class="smart-form">
                        <fieldset>
                            <!-- Factory Warehouse -->
                            <section class="col col-sm-4">
                                <label>Supplier @*<em class="note note-error" ng-show="(filters.factoryRawMaterialID == null)">(Required)</em>*@</label>
                                <label class="input">
                                    <label class="input">
                                        <input type="text" name="supplierAutoComplete" id="supplierAutoComplete" ng-model="supportData.factoryRawMaterialOfficialNM" class="form-control" placeholder="Type in at least 3 chars to activate search" ng-click="method.autocompleteSupplier()" />
                                    </label>
                                </label>
                            </section>
                            <section class="col col-sm-1">
                                <label>Key Material</label>
                                <label class="input">
                                    <select class="form-control" ng-model="filters.keyRawMaterialID" ng-options="item.keyRawMaterialID as item.keyRawMaterialNM for item in keyRawMaterials  | orderBy: 'keyRawMaterialNM'">
                                        <option value=""></option>
                                    </select>
                                </label>
                            </section>

                            <!-- From Date -->
                            <section class="col col-sm-2">
                                <label>From Date <em class="note note-error" ng-show="(filters.startDate == null || filters.startDate == '')">(Required)</em></label>
                                <label class="input-group">
                                    <label class="input">
                                        <input id="startDate" type="text" class="form-control" avs-calendar ng-data-source="filters.startDate" required />
                                    </label>
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                </label>
                            </section>

                            <!-- To Date -->
                            <section class="col col-sm-2">
                                <label>To Date <em class="note note-error" ng-show="(filters.endDate == null || filters.endDate == '')">(Required)</em></label>
                                <label class="input-group">
                                    <label class="input">
                                        <input id="endDate" type="text" class="form-control" avs-calendar ng-data-source="filters.endDate" required />
                                    </label>
                                    <span class="input-group-addon">
                                        <i class="fa fa-calendar"></i>
                                    </span>
                                </label>
                            </section>

                            <section class="col col-sm-1">
                                <label>Due Color</label>
                                <label class="input">
                                    <select class="form-control" ng-model="filters.dueColorID" ng-options="item.dueColorID as item.dueColorNM for item in dueColors  | orderBy: 'dueColorNM'">
                                        <option value=""></option>
                                    </select>
                                </label>
                            </section>

                        </fieldset>
                    </div>
                </div>
            </div>
        </div>
    </article>
    <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <div class="jarviswidget" id="wid-id-general" data-widget-editbutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false">
            <header>
                <ul class="nav nav-tabs pull-left in">
                    <li class="active">
                        <a data-toggle="tab" href="#hb6"> <i class="fa fa-bar-chart-o"></i> <span class="hidden-mobile hidden-tablet">General</span> </a>
                    </li>
                    <li>
                        <a data-toggle="tab" href="#hb7"> <i class="fa fa-bar-chart-o"></i> <span class="hidden-mobile hidden-tablet">Detail</span> </a>
                    </li>
                    @if (Frontend.Helper.AuthHelper.GetActionButtonStatus(ViewBag.ModuleCode, Frontend.Helper.ActionEnum.Approve, HttpContext.Current) != "disabled")
                    {
                    <li>
                        <a data-toggle="tab" href="#hb8" ng-click="event.getpurchaseinvoice()"> <i class="fa fa-bar-chart-o"></i> <span class="hidden-mobile hidden-tablet">The list of Invoice</span> </a>
                    </li>
                    }
                    
                </ul>
            </header>
            <div>
                <div class="jarviswidget-editbox"></div>

                <div class="widget-body">
                    <div class="tab-content">

                        <div class="tab-pane active" id="hb6">
                            <div class="row">
                                <div class="col-sm-12 m-bottom-15">
                                    <div class="tilsoft-table-wrapper" avs-scrollable-table>
                                        <div class="tilsoft-table">
                                            <div class="tilsoft-table-header" style="width:1700px;">
                                                <div style="width:45px; height:60px;"><b style="font-size: 12px; font-family: Arial">#</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Supplier Code</b></div>
                                                <div style="width:350px; height:60px;"><b style="font-size: 12px; font-family: Arial">Supplier Name</b></div>
                                                <div class="no-padding" style="width: 300px; height: 60px; text-align: center;">
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px"><b style="font-size: 12px; font-family: Arial">Beginning Balance (VND)</b></div>
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px">
                                                        <div class="no-padding" style="width: 150px; text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Debit</b></div>
                                                        <div class="no-padding" style="text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Credit</b></div>
                                                    </div>
                                                </div>
                                                <div class="no-padding" style="width: 300px; height: 60px; text-align: center;">
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px"><b style="font-size: 12px; font-family: Arial">Arising Balance (VND)</b></div>
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px">
                                                        <div class="no-padding" style="width: 150px; text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Debit</b></div>
                                                        <div class="no-padding" style="text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Credit</b></div>
                                                    </div>
                                                </div>
                                                <div class="no-padding" style="width: 300px; height: 60px; text-align: center;">
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px"><b style="font-size: 12px; font-family: Arial">Ending balance (VND)</b></div>
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px">
                                                        <div class="no-padding" style="width: 150px; text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Debit</b></div>
                                                        <div class="no-padding" style="text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Credit</b></div>
                                                    </div>
                                                </div>
                                                <div class="no-padding" style="width: 200px; height: 60px; text-align: center;">
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px"><b style="font-size: 12px; font-family: Arial">Ending balance (USD)</b></div>
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px">
                                                        <div class="no-padding" style="width: 100px; text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Debit</b></div>
                                                        <div class="no-padding" style="text-align: center; height: 30px; line-height: 30px;"><b style="font-size: 12px; font-family: Arial">Credit</b></div>
                                                    </div>
                                                </div>
                                                <div style="border-bottom:none; height:60px;"></div>
                                            </div>

                                            <div class="tilsoft-table-totalrow" style="width:1700px; margin-top: 60px">
                                                <div style="width:545px; text-align:center;">Total</div>
                                                <div style="width:150px">{{method.sumBeginningBalanceDebt() | currency : '' : 0}}</div>
                                                <div style="width:150px">{{method.sumBeginningBalanceHave() | currency : '' : 0}}</div>
                                                <div style="width:150px">{{method.sumtotalPurchaseInvoice() | currency : '' : 0}}</div>
                                                <div style="width:150px">{{method.sumtotalPaymentVoucherInvoice() | currency : '' : 0}}</div>
                                                <div style="width:150px">{{method.sumEndingBalanceDebt() | currency : '' : 0}}</div>
                                                <div style="width:150px">{{method.sumEndingBalanceHave() | currency : '' : 0}}</div>
                                                <div style="width:100px">{{method.sumEndingBalanceUSDDebt() | currency : '' : 0}}</div>
                                                <div style="width:100px">{{method.sumEndingBalanceUSDHave() | currency : '' : 0}}</div>
                                                <div></div>
                                            </div>

                                            <div class="tilsoft-table-body" style="width:1700px; margin-top:90px">
                                                <table>
                                                    <tbody>
                                                        <tr ng-repeat="item in data.totalLiabilities">
                                                            <td style="width:44px; text-align:center;">{{$index+1}}</td>
                                                            <td style="width:150px; text-align:left;">{{item.factoryRawMaterialUD}}</td>
                                                            <td style="width:350px; text-align:left;">{{item.factoryRawMaterialOfficialNM}}</td>
                                                            <td style="width:150px; text-align:right">{{item.beginningDebt | currency : '' : 0}}</td>
                                                            <td style="width:150px; text-align:right">{{item.beginningHas | currency : '' : 0}}</td>
                                                            <td style="width:150px; text-align:right">{{item.totalPurchaseInvoice | currency : '' : 0}}</td>
                                                            <td style="width:150px; text-align:right">{{item.totalPaymentVoucherInvoice | currency : '' : 0}}</td>
                                                            <td style="width:150px; text-align:right">{{item.endingBalanceDebt | currency : '' : 0}}</td>
                                                            <td style="width:150px; text-align:right">{{item.endingBalanceHas | currency : '' : 0}}</td>
                                                            <td style="width:100px; text-align:right">{{item.endingBalanceUSDDebt | currency : '' : 0}}</td>
                                                            <td style="width:100px; text-align:right">{{item.endingBalanceUSDHas | currency : '' : 0}}</td>
                                                            <td style="border-bottom:none;"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="tab-pane" id="hb7">
                            <div class="row">
                                <section class="col col-sm-4">
                                    <div class="tilsoft-table-wrapper" avs-scrollable-table>
                                        <div class="tilsoft-table">
                                            <div class="tilsoft-table-header" style="width:460px">
                                                <div style="width:100px ; height:60px;"></div>
                                                <div style="width:80px; height:60px;"><b style="font-size: 12px; font-family: Arial">Head Count</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">AP amount (USD)</b></div>
                                                <div style="width:70px; height:60px;"><b style="font-size: 12px; font-family: Arial">Ratio</b></div>
                                                <div style="border-bottom:none; height:60px;"></div>
                                            </div>
                                            <div class="tilsoft-table-totalrow" style="width:530px; margin-top: 60px;">
                                                <div style="width:100px ; height:30px;"></div>
                                                <div style="width:80px; height:30px;"><b style="font-size: 11px; font-family: Arial">{{supportData.totalCount | number : 0}}</b></div>
                                                <div style="width:150px; height:30px;"><b style="font-size: 11px; font-family: Arial">{{method.sumAPAmount() | number : 2}}</b></div>
                                                <div style="width:70px; height:30px;"><b style="font-size: 11px; font-family: Arial">100%</b></div>
                                                <div style="border-bottom:none; height:30px;"></div>
                                            </div>
                                            <div class="tilsoft-table-body" style="width:460px; margin-top: 90px;">
                                                <table>
                                                    <tbody ng-repeat="item in data.listColorCatagoryDTOs">
                                                        <tr>
                                                            <td style="width: 100px; background-color: {{item.colorUD}}">{{item.colorName}}</td>
                                                            <td style="width: 80px; text-align: right; background-color: {{item.colorUD}}">{{item.totalCount | number : 0}}</td>
                                                            <td style="width: 150px; text-align: right; background-color: {{item.colorUD}}">{{item.totalAmount | number : 2}}</td>
                                                            <td style="width: 70px; text-align: right">{{item.totalAmount / method.sumAPAmount() * 100 | number : 2}}%</td>
                                                            <td style="border-bottom: none;"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section class="col col-sm-4">
                                    <div class="tilsoft-table-wrapper" avs-scrollable-table>
                                        <div class="tilsoft-table">
                                            <div class="tilsoft-table-header" style="width:460px">
                                                <div style="width:150px ; height:60px;"><b style="font-size: 12px; font-family: Arial">Creditor aging</b></div>
                                                <div style="width:120px; height:60px;"><b style="font-size: 12px; font-family: Arial">No of Creditor</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">AP amount (USD)</b></div>
                                                <div style="border-bottom:none; height:60px;"></div>
                                            </div>
                                            <div class="tilsoft-table-totalrow" style="width:530px; margin-top: 60px;">
                                                <div style="width:150px ; height:30px;"></div>
                                                <div style="width:120px; height:30px;"><b style="font-size: 11px; font-family: Arial">{{supportData.totalCountColor | number : 0}}</b></div>
                                                <div style="width:150px; height:30px;"><b style="font-size: 11px; font-family: Arial">{{method.sumColorAmount() | number : 2}}</b></div>
                                                <div style="border-bottom:none; height:30px;"></div>
                                            </div>
                                            <div class="tilsoft-table-body" style="width:460px; margin-top: 90px;">
                                                <table>
                                                    <tbody ng-repeat="item in data.listChartDetailDTOs">
                                                        <tr>
                                                            <td style="width: 150px; background-color: {{item.dueColorUD}}">{{item.dueColorNM}}</td>
                                                            <td style="width: 120px; text-align: right; background-color: {{item.dueColorUD}}">{{item.totalCount | number : 0}}</td>
                                                            <td style="width: 150px; text-align: right; background-color: {{item.dueColorUD}}">{{item.totalAmount | number : 2}}</td>
                                                            <td style="border-bottom: none;"></td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                            </div>
                            <div class="row">
                                <div id="highchartabc" style="min-width: 310px; height: 500px; margin: 0 auto"></div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 m-bottom-15">

                                    <div class="tilsoft-table-wrapper" avs-scrollable-table>
                                        <div class="tilsoft-table">
                                            <div class="tilsoft-table-header" style="width:2100px">
                                                <div style="width:50px; height:60px;"><b style="font-size: 12px; font-family: Arial">#</b></div>
                                                <div style="width:200px; height:60px;"><b style="font-size: 12px; font-family: Arial">Invoice Date</b></div>
                                                <div style="width:80px; height:60px;"><b style="font-size: 12px; font-family: Arial">Key Material</b></div>
                                                <div style="width:200px; height:60px;"><b style="font-size: 12px; font-family: Arial">Invoice number</b></div>
                                                <div style="width:85px; height:60px;"><b style="font-size: 12px; font-family: Arial">Invoice currency</b></div>
                                                <div style="width:200px; height:60px;"><b style="font-size: 12px; font-family: Arial">Description</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Payment Term</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Invoice Amount <br /> (VND)</b></div>
                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Beginning Balance (VND)</b></div>
                                                @*<div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Amount Paid (VND)</b></div>*@
                                                <div style="width: 300px; height:60px" class="no-padding">
                                                    <div class="no-padding" style="width: 100%; height: 30px; border-right: none; line-height: 30px;"><b>Amount Paid (VND)</b></div>
                                                    <div class="no-padding" style="width: 100%; height: 30px;">
                                                        <div class="no-padding" style="width:150px;height: 30px; line-height: 30px;"><b>Deposit</b></div>
                                                        <div class="no-padding" style="height: 30px; line-height: 30px;"><b>Payment</b></div>
                                                    </div>
                                                </div>

                                                <div style="width:150px; height:60px;"><b style="font-size: 12px; font-family: Arial">Amount to be paid (VND)</b></div>
                                                <div style="width:130px; height:60px;"><b style="font-size: 12px; font-family: Arial">Amount to be paid (USD)</b></div>
                                                <div style="width:85px; height:60px;"><b style="font-size: 12px; font-family: Arial">Due Date</b></div>
                                                <div style="width:70px; height:60px;"><b style="font-size: 12px; font-family: Arial">Due Day</b></div>
                                                <div style="border-bottom:none; height:60px;"></div>
                                            </div>
                                            <div class="tilsoft-table-body" style="width:2100px; margin-top: 60px;">
                                                <table>
                                                    <tbody ng-repeat="item in data.sumDetailOfLiabilities">
                                                        <tr style="background: #fbd8d5">
                                                            <td style="width: 50px; text-align: center;"><b>{{($index + 1)}}</b></td>
                                                            <td style="width: 200px; text-align: center;"><b>{{item.factoryRawMaterialOfficialNM}}</b></td>
                                                            <td style="width: 80px; ">{{item.keyRawMaterialNM}}</td>
                                                            <td style="width: 200px; "></td>
                                                            <td style="width: 85px; "></td>
                                                            <td style="width: 200px; text-align: center;"><b>{{item.remark}}</b></td>
                                                            <td style="width: 150px; "></td>
                                                            <td style="width: 150px; text-align: right;"><b>{{method.sumInvoiceAmount(item.detailOfLiabilitiesDto) | currency : '' : 2}}</b></td>
                                                            <td style="width: 150px; text-align: right;"><b>{{method.sumBeginningBalance(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) | currency : '' : 2}}</b></td>
                                                            @*<td style="width: 150px; text-align: right;"><b>{{method.sumAmountPaid(item.detailOfLiabilitiesDto) | currency : '' : 2}}</b></td>*@
                                                            <td style="width: 150px; text-align: right;"><b>{{method.sumDeposit(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) | currency : '' : 2}}</b></td>
                                                            <td style="width: 150px; text-align: right;"><b>{{method.sumPayment(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) | currency : '' : 2}}</b></td>
                                                            <td style="width: 150px; text-align: right;"><b>{{method.sumInvoiceAmount(item.detailOfLiabilitiesDto) - method.sumBeginningBalance(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) - method.sumDeposit(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) - method.sumPayment(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) | currency : '' : 2}}</b></td>
                                                            <td style="width: 130px; text-align: right;"><b>{{(method.sumInvoiceAmount(item.detailOfLiabilitiesDto) - method.sumBeginningBalance(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) - method.sumDeposit(item.detailOfLiabilitiesDto, item.factoryRawMaterialID) - method.sumPayment(item.detailOfLiabilitiesDto, item.factoryRawMaterialID)) / item.exchangeRate | currency : '' : 2}}</b></td>
                                                            <td style="width: 85px; "></td>
                                                            <td style="width: 70px; "></td>
                                                            <td style="border-bottom: none;"></td>
                                                        </tr>
                                                        <tr ng-repeat="wItem in item.detailOfLiabilitiesDto">
                                                            <td colspan="15" class="no-padding">
                                                                <table style="margin: 0px" class="no-padding">
                                                                    <tbody>
                                                                        <tr style="background: #ecffff" class="no-padding">
                                                                            <td style="width: 50px; font-size: 12px; text-align: center;">
                                                                                <a href="javascript:void(0)" title="Show Details" ng-click="event.openDetailOfLiabilities(wItem)" ng-hide="(wItem.numberRowDetail == 0)">[{{(!wItem.openDetailOfLiabilities ? '+' : '-')}}]</a>
                                                                            </td>
                                                                            <td style="width: 200px; text-align: center">{{wItem.purchaseInvoiceDate}}</td>
                                                                            <td style="width: 80px;">{{wItem.keyRawMaterialNM}}</td>
                                                                            <td style="width: 200px; text-align: center;">
                                                                                <a href="@Url.Action("Edit", "PurchaseInvoiceMng")/{{wItem.purchaseInvoiceID}}" target="_blank">{{wItem.invoiceNo}}</a>
                                                                            </td>
                                                                            <td style="width:85px">{{wItem.currency}}</td>
                                                                            <td style="width: 200px; text-align: center;">{{wItem.remark}}</td>
                                                                            <td style="width: 150px; text-align: center;">{{wItem.supplierPaymentTermNM}}</td>
                                                                            <td style="width: 150px; text-align: right;">{{wItem.toTalInvoiceAmount | currency : '' : 2}}</td>
                                                                            <td style="width: 150px; text-align: right;">{{wItem.beginningBalance | currency : '' : 2}}</td>
                                                                            @*<td style="width: 150px; text-align: right;">{{method.sumReceipt(wItem.detailOfLiabilitiesByInvoiceNoDto) | currency : '' : 2}}</td>*@
                                                                            <td style="width: 150px; text-align: right;">{{wItem.totalRealDeposit | currency : '' : 2}}</td>
                                                                            <td style="width: 150px; text-align: right;">{{wItem.totalAmount | currency : '' : 2}}</td>
                                                                            <td style="width: 150px; text-align: right;">{{wItem.toTalInvoiceAmount - wItem.beginningBalance - wItem.totalAmount - wItem.totalRealDeposit | currency : '' : 2}}</td>
                                                                            <td style="width: 130px; text-align: right;">{{(wItem.toTalInvoiceAmount - wItem.beginningBalance - wItem.totalAmount - wItem.totalRealDeposit) / wItem.exchangeRate | currency : '' : 2}}</td>
                                                                            <td style="width: 85px">{{wItem.dueDate}}</td>
                                                                            <td style="width: 70px; text-align: right; background-color: {{wItem.dueColorUD}}">{{wItem.dueDay}}</td>
                                                                            @*<td style="border-bottom: none;"></td>*@
                                                                        </tr>
                                                                        <tr ng-repeat="itemDetail in wItem.detailOfLiabilitiesByInvoiceNoDto" ng-hide="!wItem.openDetailOfLiabilities">
                                                                            <td style="width: 50px"></td>
                                                                            <td style="width: 200px; text-align: center;">{{itemDetail.postingDate}}</td>
                                                                            <td style="width: 80px"></td>
                                                                            <td style="width: 200px; text-align: center;">
                                                                                <a href="@Url.Action("Edit", "PaymentNoteMng")/{{itemDetail.paymentNoteID}}" target="_blank">{{itemDetail.paymentNoteNo}}</a>
                                                                            </td>
                                                                            <td style="width: 85px">{{itemDetail.currency}}</td>
                                                                            <td style="width: 210px; text-align: center;">{{itemDetail.remark}}</td>
                                                                            <td style="width: 160px;"></td>
                                                                            <td style="width: 150px;"></td>
                                                                            <td style="width: 150px;"></td>
                                                                            @*<td style="width: 150px; text-align: right;">{{itemDetail.amountByCurrency | currency : '' : 2}}</td>*@
                                                                            <td style="width: 150px; "></td>
                                                                            <td style="width: 150px; text-align: right;">{{itemDetail.amountByCurrency | currency : '' : 2}}</td>
                                                                            <td style="width: 150px; "></td>
                                                                            <td style="width: 130px; "></td>
                                                                            <td style="width: 85px; "></td>
                                                                            <td style="width: 70px; "></td>
                                                                            @*<td style="border-bottom: none;"></td>*@
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        <div class="tab-pane" id="hb8">
                            <div class="row">
                                <div class="col-sm-12 m-bottom-15">
                                    <div class="tilsoft-table-wrapper"  avs-scrollable-table>
                                        <div class="tilsoft-table">
                                            <div class="tilsoft-table-header" style="width: 2000px; height: 60px">
                                                <div style="width: 80px;">
                                                    <a href="javascript:void(0)" class="btn btn-default btn-xs" title="Apply Filter" ng-click="event.getpurchaseinvoice()"><i class="fa fa-filter"></i></a>
                                                    <a href="javascript:void(0)" class="btn btn-default btn-xs" title="Clear Filter" ng-click="event.clear()">
                                                        <i class="fa fa-ban"></i>
                                                    </a>
                                                </div>
                                                <div style="width: 100px">DOC CODE</div>
                                                <div style="width: 100px">INVOICE NO</div>
                                                <div style="width: 300px">SUPPLIER</div>
                                                <div style="width: 360px" class="no-padding">
                                                    <div class="no-padding" style="width: 100%; height: 25px; border-right: none; line-height: 30px;">INVOICE AMOUNT (+VAT)</div>
                                                    <div class="no-padding" style="width: 100%; height: 25px;">
                                                        <div class="no-padding" style="width:120px;height: 25px; line-height: 30px;">AMOUNT</div>
                                                        <div class="no-padding" style="width:120px;height: 25px; line-height: 30px;">PAYMENT</div>
                                                        <div class="no-padding" style="height: 25px; line-height: 30px;">REMAIN</div>
                                                    </div>
                                                </div>
                                                <div style="width: 240px" class="no-padding">
                                                    <div class="no-padding" style="width: 100%; height: 25px; border-right: none; line-height: 30px;">PAYMENT PLANNING</div>
                                                    <div class="no-padding" style="width: 100%; height: 25px;">
                                                        <div class="no-padding" style="width:120px;height: 25px; line-height: 30px;">PAYMENT</div>
                                                        <div class="no-padding" style="height: 25px; line-height: 30px;">REMAIN</div>
                                                    </div>
                                                </div>
                                                <div style="width: 100px">CURRENCY</div>
                                                <div style="width: 100px">INVOICE DATE</div>
                                                <div style="width: 80px">DUE DAY</div>
                                                <div style="width: 150px">KEY MATERIAL</div>
                                                <div>REMARK</div>
                                            </div>

                                            <div class="tilsoft-table-filter" style="width: 2000px; margin-top: 50px">
                                                <div style="width:80px;">
                                                    <label style="display:inline; vertical-align:middle;">
                                                        <a class="btn btn-primary btn-xs font-11" ng-click="event.process()" title="Process">Proc</a>
                                                    </label>
                                                    <label style="display:inline; vertical-align:middle">
                                                        <input type="checkbox"
                                                               title="Select all"
                                                               ng-model="isAllSelected"
                                                               ng-click="event.selectAll()">
                                                    </label>
                                                </div>
                                                <div style="width:100px">
                                                    <input type="text" ng-model="filters2.purchaseInvoiceUD" class="search-filter form-control" />
                                                </div>
                                                <div style="width:100px">
                                                    <input type="text" ng-model="filters2.invoiceNo" class="search-filter form-control" />
                                                </div>
                                                <div style="width:300px">
                                                    <select style="padding: 0px; border:none" avs-select id="factoryRawMaterialID" class="search-filter" ng-model="filters2.factoryRawMaterialID" ng-options="item2.factoryRawMaterialID as item2.factoryRawMaterialOfficialNM for item2 in supplierDTO | orderBy : 'factoryRawMaterialOfficialNM'">
                                                        <option value=""></option>
                                                    </select>
                                                </div>
                                                <div style="width:120px">
                                                    <b>{{ method.totalAmountPI() | number : 0 }}</b>
                                                </div>
                                                <div style="width:120px">
                                                    <b>{{method.totalPaymentPI() | number : 0}}</b>
                                                </div>
                                                <div style="width:120px">
                                                    <b>{{method.totalRemainPI() | number : 0}}</b>
                                                </div>
                                                <div style="width:120px"></div>
                                                <div style="width:120px"></div>
                                                <div style="width:100px"></div>
                                                <div style="width:100px"></div>
                                                <div style="width:80px"></div>
                                                <div style="width:150px">
                                                    <select class="form-control" ng-model="filters2.keyRawMaterialID" ng-options="item.keyRawMaterialID as item.keyRawMaterialNM for item in keyRawMaterials  | orderBy: 'keyRawMaterialNM'">
                                                        <option value=""></option>
                                                    </select>
                                                </div>
                                                <div></div>
                                            </div>

                                            <div class="tilsoft-table-body" style="width: 2000px; margin-top: 80px">
                                                <table>
                                                    <tbody>
                                                        @*<tr>
                                                            <td style="text-align: center; width: 79px; vertical-align:middle"></td>
                                                            <td style="width: 100px;"></td>
                                                            <td style="width: 100px;"></td>
                                                            <td style="width: 300px;"></td>
                                                            <td style="width: 150px; text-align:right"></td>
                                                            <td style="width: 100px"></td>
                                                            <td style="width: 100px"></td>
                                                            <td style="width: 80px"></td>
                                                            <td style="width: 150px;"></td>
                                                            <td></td>
                                                        </tr>*@
                                                        <tr ng-repeat="item in purchaseInvoiceDTO">
                                                            <td style="width:79px; vertical-align:middle; text-align:center">
                                                                <label>
                                                                    <input type="checkbox" ng-model="item.isSelected" ng-click="event.selectInvoice(item)">
                                                                    <i style="top:0px; left:20px"></i>
                                                                </label>
                                                            </td>
                                                            &nbsp;
                                                            <td style="width: 100px; text-align:center">
                                                                <a href="@Url.Action("Edit", "PurchaseInvoiceMng")/{{item.purchaseInvoiceID}}" target="_blank">{{item.purchaseInvoiceUD}}</a>
                                                            </td>
                                                            <td style="width: 100px; text-align: center;">{{item.invoiceNo}}</td>
                                                            <td style="width: 300px;">
                                                                {{item.factoryRawMaterialOfficialNM}}
                                                            </td>
                                                            <td style="width: 120px;" class="text-right">
                                                                {{item.totalAmount | currency : '' : 0}}
                                                            </td>
                                                            <td style="width: 120px;" class="text-right">
                                                                {{item.totalPayment | currency : '' : 0}}
                                                            </td>
                                                            <td style="width: 120px;" class="text-right">
                                                                {{event.calRemain(item) | currency : '' : 0}}
                                                            </td>
                                                            <td ng-if="!item.isSelected" style="width: 120px;" class="text-right">0</td>
                                                            <td ng-if="item.isSelected" style="width: 120px;" class="text-right">
                                                                <input avs-number type="text" ng-data-source="item.planPayment" ng-decimal="0" class="form-control"/>
                                                            </td>
                                                            <td style="width: 120px;" class="text-right">
                                                                {{event.calPlanRemain(item) | currency : '' : 0}}
                                                            </td>
                                                            <td style="width: 100px;">
                                                                {{item.currency}}
                                                            </td>
                                                            <td style="width: 100px;">{{item.purchaseInvoiceDate}}</td>
                                                            <td style="width: 80px; text-align: right">{{item.dueDay}}</td>
                                                            <td style="width: 150px;">
                                                                {{item.keyRawMaterialNM}}
                                                            </td>
                                                            <td>
                                                                <textarea style="background:none" ng-model="item.remark" rows="4" disabled></textarea>
                                                            </td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>
</div>

@section FormAction{
<ul id="sparks">
    <li>
        <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="event.getTotalLiabilities()">
            <i class="fa fa-search"></i>
        </a>
    </li>
    <li style="display:none">
        <a href="javascript:void(0)" class="btn btn-default btn-sm" title="Show data on excel">
            <i class="fa fa-file-excel-o"></i>
        </a>
    </li>
    @if (!string.IsNullOrEmpty(userManualUrl))
    {
        <li class="sparks-info">
            <a target="_blank" href="@userManualUrl" class="btn btn-default" title="Help"><i class="fa fa-info"></i></a>
        </li>
    }
</ul>
}

@section pagejs{
    <script type="text/javascript">
        var context = {
            serviceUrl: '@(serviceRoot)/api/accountpayablerpt/',
            token: '@token',
            pageSize: '@pageSize',
            backendReportUrl: '@backendReportUrl',
            errMsg: '@Frontend.Properties.Resources.INPUT_VALIDATION_FAILED',
        };
    </script>
    <script type="text/javascript" src="~/Views/AccountPayableRpt/index.js"></script>
    <script type="text/javascript" src="~/Angular/app/jsonService2.js?v=@guid"></script>
    <script type="text/javascript" src="~/Views/AccountPayableRpt/service.js?v=@guid"></script>
}
