@{
    ViewBag.Title = "User Profile";
    ViewBag.Icon = "fa-user";
    ViewBag.Module = "User Profile";
}
<div class="row tilsoft-profile" id="main-form">
    <div class="col-sm-12">
        <div id="profile-section" class="well well-sm" style="background: #fff;">
            <div class="row">
                <div class="col-sm-12">
                    <div style="background: url('@System.Web.VirtualPathUtility.ToAbsolute("~/img/demo/s1.jpg")') top left no-repeat; height: 150px; background-size: cover;"></div>
                    <div style="position: relative;">
                        <div class="air air-bottom-right" style="margin: 10px; background: rgba(0,0,0,0.5); color: #fff; font-size: 25px; padding: 10px 20px;">
                            <i class="fa fa-briefcase"></i> {{data.internalCompanyNM}}
                        </div>
                    </div>
                </div>
                <div class="col-sm-12">
                    <div class="row">
                        <div class="col-sm-2">
                            <div class="profile-image">
                                <a href="{{data.fileLocation}}" data-featherlight="image">
                                    <img style="width: 95%;" ng-src="{{data.thumbnailLocation}}" />
                                </a>

                                <a href="#" class="btn btn-success" style="margin-top: 10px; width: 100%;" ng-click="profileService.openForm()"><i class="fa fa-pencil"></i> Edit</a>
                            </div>
                        </div>
                        <div class="col-sm-10">
                            <h1>
                                {{data.employeeNM}} (Calling name: {{data.employeeFirstNM}})
                                <br />
                                <span class="small">{{data.jobTitle}} (Level: {{data.jobLevelNM}})</span>
                            </h1>
                            <div class="row">
                                <div class="col-sm-4">
                                    <ul class="list-unstyled">
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-phone"></i>
                                                <a href="#">{{data.telephone1}}</a>
                                                <br />
                                                <a href="#">{{data.telephone2}}</a>
                                                &nbsp;
                                            </p>
                                        </li>
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-envelope"></i>
                                                <a href="mailto:{{data.email1}}">{{data.email1}}</a>
                                                <br />
                                                <a href="mailto:{{data.email2}}">{{data.email2}}</a>
                                                &nbsp;
                                            </p>
                                        </li>
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-skype"></i>
                                                <a href="skype:{{data.skypeID}}:chat">{{data.skypeID}}</a>
                                                &nbsp;
                                            </p>
                                        </li>
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-calendar-o"></i>
                                                <span class="txt-color-darken">{{data.dateOfBirth}}</span>
                                                &nbsp;
                                            </p>
                                        </li>
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-map-marker"></i>
                                                <span class="txt-color-darken">{{data.locationNM}}</span>
                                                &nbsp;
                                            </p>
                                        </li>
                                        <li>
                                            <p class="text-muted">
                                                <i class="fa fa-file-word-o"></i>
                                                Resume: <a ng-if="data.cvFileLocation" target="_blank" href="{{data.cvFileLocation}}">{{data.cvFileName}}</a>
                                            </p>
                                        </li>
                                    </ul>
                                </div>
                                <div class="col-sm-8">
                                    <table class="table table-bordered table-striped">
                                        <tbody>
                                            <tr>
                                                <th><i class="fa fa-calendar-o"></i> Joined Date</th>
                                                <td>{{data.dateStart}}</td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-paper-plane-o"></i> Report To</th>
                                                <td>
                                                    <a ng-if="data.reportToID" href="@Url.Action("Detail", "EmployeeMng", new { id = UrlParameter.Optional })/{{data.reportToID}}" data-featherlight="iframe" data-featherlight-iframe-allowfullscreen="true" data-featherlight-iframe-width="800" data-featherlight-iframe-height="600">
                                                        {{data.managerName}}
                                                    </a>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-briefcase"></i> Department</th>
                                                <td>{{data.internalDepartmentNM}}</td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-briefcase"></i> Factory</th>
                                                <td>
                                                    <div class="bootstrap-tagsinput" style="border: none; padding: 0px;">
                                                        <span class="tag label label-info" ng-repeat="item in data.employeeFactories">
                                                            {{item.factoryUD}}
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-certificate"></i> English</th>
                                                <td>{{data.english}}</td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-gears"></i> TILSOFT Usage</th>
                                                <td>TILSOFT USAGE</td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-gears"></i> TILSOFT Licensed From</th>
                                                <td>{{data.licensedDate}}</td>
                                            </tr>
                                            <tr>
                                                <th><i class="fa fa-random"></i> Other contact method</th>
                                                <td>{{data.otherContactInfo}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="font-md">
                                        <i class="fa fa-suitcase"></i> Job Description
                                    </p>
                                    <p ng-bind-html="dataService.formatRemark(data.jobDescription)"></p>
                                </div>
                                <div class="col-sm-6">
                                    <p class="font-md">
                                        <i class="fa fa-tasks"></i> Daily Task
                                    </p>
                                    <p ng-bind-html="dataService.formatRemark(data.dailyTask)"></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="account-section" class="well well-sm" style="background: #fff;">
            <h1>TILSOFT Account</h1>
            <hr />
            <div class="row">
                <div class="col-sm-2">
                    <div class="profile-image" style="top: auto; padding-top: 0px;">
                        <a href="javascript:void(0)" class="btn btn-default" style="width: 100%;" ng-click="passwordService.openForm()"><i class="fa fa-lock"></i> Change PW</a>
                        <a href="javascript:void(0)" class="btn btn-default" style="width: 100%; margin-top: 10px;" ng-click="event.generateAPI()"><i class="fa fa-exchange"></i> Generate API</a>
                    </div>
                </div>
                <div class="col-sm-10">
                    <table class="table table-bordered table-striped">
                        <tbody>
                            <tr>
                                <th><i class="fa fa-barcode"></i> Code</th>
                                <td>{{data.userUD}}</td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-user"></i> Account</th>
                                <td>{{data.userName}}</td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-exchange"></i> Secrete key</th>
                                <td>{{data.apiKey}}</td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-users"></i> User Group</th>
                                <td>{{data.userGroupNM}}</td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-trophy"></i> Super User </th>
                                <td><i class="fa fa-check-square-o" ng-if="data.isSuperUser"></i></td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-calendar-o"></i> Last Login</th>
                                <td>{{data.lastLoginDate}}</td>
                            </tr>
                            <tr>
                                <th><i class="fa fa-calendar-o"></i> Last Password Changed</th>
                                <td>{{data.lastPasswordChanged}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- SWITCH FORM -->
<div id="frmProfile" class="row" style="display: none;">
    <form name="frmProfile">
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="jarviswidget" id="wid-account-form" data-widget-colorbutton="false" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false" role="widget">
                <header role="heading">
                    <h2>Edit Profile</h2>
                </header>
                <div role="content">
                    <div class="widget-body no-padding">
                        <div class="smart-form">
                            <fieldset>
                                <div class="row">
                                    <section class="col col-2" style="text-align: center;">
                                        <div class="img-container">
                                            <div style="padding: 10px;">
                                                <a href="{{profileService.data.fileLocation}}" data-featherlight="image">
                                                    <img style="width: 95%;" ng-src="{{profileService.data.thumbnailLocation}}" />
                                                </a>
                                            </div>
                                        </div>
                                        <div class="img-container" style="border: none; margin-top: 15px;">
                                            <a href="javascript:void(0)" class="btn btn-default btn-sm" style="width: 100%;" ng-click="profileService.uploadPhoto()"><i class="fa fa-camera"></i> Change</a>
                                        </div>
                                    </section>
                                    <section class="col col-10">
                                        <section>
                                            <h2>Person Information</h2>
                                            <hr />
                                        </section>
                                        <div class="row">
                                            <section class="col col-6">
                                                <label class="label">
                                                    Full Name
                                                    <em ng-show="frmProfile.fullname.$error.required" class="note note-error">(Required)</em>
                                                </label>
                                                <label class="input" ng-class="{'state-error': frmProfile.fullname.$error.required}">
                                                    <input name="fullname" type="text" ng-model="profileService.data.employeeNM" required />
                                                </label>
                                            </section>
                                            <section class="col col-2">
                                                <label class="label">Calling Name</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.employeeFirstNM" />
                                                </label>
                                            </section>
                                            <section class="col col-4">
                                                <label class="label">DOB</label>
                                                <label class="input">
                                                    <i class="icon-append fa fa-calendar"></i>
                                                    <input type="text" data-dateformat="dd/mm/yy" class="datepicker" ng-model="profileService.data.dateOfBirth" />
                                                </label>
                                            </section>
                                        </div>
                                        <div class="row">
                                            <section class="col col-6">
                                                <label class="label">
                                                    Resume File
                                                </label>
                                                <label class="input">
                                                    <span class="form-control">
                                                        {{profileService.data.cvFileName}}
                                                        <div style="position: absolute; right: 5px; top: 5px;">
                                                            <a ng-disabled="!profileService.data.cvFileLocation" href="{{profileService.data.cvFileLocation}}" target="_blank" class="btn btn-primary btn-xs" style="font-size: 11px;">Download</a>
                                                            <a href="javascript:void(0);" class="btn btn-primary btn-xs" style="font-size: 11px;" ng-click="profileService.changeCVFile()">Change</a>
                                                            <a ng-disabled="!profileService.data.cvFileLocation" href="javascript:void(0);" class="btn btn-danger btn-xs" style="font-size: 11px;" ng-click="profileService.removeCVFile()">Remove</a>
                                                        </div>
                                                    </span>
                                                </label>
                                            </section>

                                            <section class="col col-6">
                                                <label class="label">
                                                    Signature file
                                                </label>
                                                <label class="input">
                                                    <span class="form-control">
                                                        {{profileService.data.signatureFileName}}
                                                        <div style="position: absolute; right: 5px; top: 5px;">
                                                            <a href="javascript:void(0);" class="btn btn-primary btn-xs" style="font-size: 11px;" ng-click="profileService.changeSignatureFile()">Change</a>
                                                            <a ng-disabled="!profileService.data.signatureFileLocation" href="javascript:void(0);" class="btn btn-danger btn-xs" style="font-size: 11px;" ng-click="profileService.removeSignatureFile()">Remove</a>
                                                        </div>
                                                    </span>
                                                </label>
                                            </section>
                                        </div>

                                        <section>
                                            <h2>Contact Information</h2>
                                            <hr />
                                        </section>
                                        <div class="row">
                                            <section class="col col-3">
                                                <label class="label">Telephone 1</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.telephone1" />
                                                </label>
                                            </section>
                                            <section class="col col-3">
                                                <label class="label">Telephone 2</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.telephone2" />
                                                </label>
                                            </section>
                                            <section class="col col-3">
                                                <label class="label">Email 1</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.email1" />
                                                </label>
                                            </section>
                                            <section class="col col-3">
                                                <label class="label">Email 2</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.email2" />
                                                </label>
                                            </section>
                                        </div>
                                        <div class="row">
                                            <section class="col col-3">
                                                <label class="label">Skype ID</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.skypeID" />
                                                </label>
                                            </section>
                                            <section class="col col-6">
                                                <label class="label">Other Contact Method</label>
                                                <label class="input">
                                                    <input type="text" ng-model="profileService.data.otherContactInfo" />
                                                </label>
                                            </section>
                                            <section class="col col-3">
                                                <label class="label">Location</label>
                                                <label class="select">
                                                    <select ng-model="profileService.data.locationID" ng-options="location.locationID as location.locationNM for location in locations">
                                                        <option value=""></option>
                                                    </select>
                                                    <i></i>
                                                </label>
                                            </section>
                                        </div>
                                    </section>
                                </div>
                            </fieldset>
                        </div>
                        <div class="widget-footer">
                            <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="profileService.update()"><i class="fa fa-check"></i> Save</a>
                            <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="profileService.closeForm()"><i class="fa fa-times"></i> Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </article>
    </form>
</div>

<div id="frmPassword" class="row" style="display: none;">
    <form name="frmPassword">
        <article class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="jarviswidget" id="wid-permission-form" data-widget-colorbutton="false" data-widget-togglebutton="false" data-widget-editbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false" role="widget">
                <header role="heading">
                    <h2>Change Password</h2>
                </header>
                <div role="content">
                    <div class="widget-body no-padding">
                        <div class="smart-form">
                            <fieldset>
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">
                                            New Password
                                            <em ng-show="frmPassword.password.$error.required" class="note note-error">(Required)</em>
                                            <em ng-show="frmPassword.password.$error.minlength" class="note note-error">(Password must be at least 7 chars length)</em>
                                        </label>
                                        <label class="input" ng-class="{'state-error': frmPassword.password.$error.required || frmPassword.password.$error.minlength}">
                                            <input type="password" ng-model="passwordService.data.newPassword" name="password" required ng-minlength="7" />
                                        </label>
                                    </section>
                                </div>
                                <div class="row">
                                    <section class="col col-6">
                                        <label class="label">
                                            Confirmation
                                            <em ng-show="frmPassword.confirmation.$error.required" class="note note-error">(Required)</em>
                                            <em ng-show="frmPassword.confirmation.$error.minlength" class="note note-error">(Password must be at least 7 chars length)</em>
                                        </label>
                                        <label class="input" ng-class="{'state-error': frmPassword.confirmation.$error.required || frmPassword.confirmation.$error.minlength}">
                                            <input type="password" ng-model="passwordService.data.confirmation" name="confirmation" required ng-minlength="7" />
                                        </label>
                                    </section>
                                </div>
                            </fieldset>
                        </div>
                        <div class="widget-footer">
                            <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="passwordService.update()"><i class="fa fa-check"></i> Save</a>
                            <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="passwordService.closeForm()"><i class="fa fa-times"></i> Cancel</a>
                        </div>
                    </div>
                </div>
            </div>
        </article>
    </form>
</div>

@section FormAction {
}

@section pagejs {
    <script type="text/javascript">
        var context = {
            errMsg: '@Frontend.Properties.Resources.INPUT_VALIDATION_FAILED',
            refreshUrl: '@Url.Action("Index", "Profile", new { id = UrlParameter.Optional })/',
            serviceUrl: '@(System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"])api/profile/',
            token: '@Session[Frontend.Customize.Common.ProjectDefinition.TOKEN_SESSION]',
            supportServiceUrl: '@(System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"])api/support/',
        };
    </script>
    <script src="~/Angular/app/profile/index.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/jsonService2.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/profile/service.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/profile/index/profileService.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/profile/index/passwordService.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
}

