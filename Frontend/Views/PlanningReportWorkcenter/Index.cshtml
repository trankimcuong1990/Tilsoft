@using Frontend.Helper;
@{
    ViewBag.Title = "Planning Report Workcenter";
    ViewBag.Icon = "fa-bar-chart-o";
}

<style>
    /*.tilsoft-table-header, .tilsoft-table-filter, .tilsoft-table-body {
        width: {{1060 + weekInfo.length*110 + 20}}px;
    }*/
    .tilsoft-table-header > div {
        height: 80px !important;
    }
    .tilsoft-table-body {
        margin-top: 80px !important;
    }
        .tilsoft-table-header > div:nth-child(1),
        .tilsoft-table-filter > div:nth-child(1),
        .tilsoft-table-body table > tbody > tr > td:nth-child(1) {
            width: 100px;
            /*text-align: center;*/
        }
        .tilsoft-table-header > div:nth-child(2),
        .tilsoft-table-filter > div:nth-child(2),
        .tilsoft-table-body table > tbody > tr > td:nth-child(2) {
            width: 80px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(3),
        .tilsoft-table-filter > div:nth-child(3),
        .tilsoft-table-body table > tbody > tr > td:nth-child(3) {
            width: 80px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(4),
        .tilsoft-table-filter > div:nth-child(4),
        .tilsoft-table-body table > tbody > tr > td:nth-child(4) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(5),
        .tilsoft-table-filter > div:nth-child(5),
        .tilsoft-table-body table > tbody > tr > td:nth-child(5) {
            width: 200px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(6),
        .tilsoft-table-filter > div:nth-child(6),
        .tilsoft-table-body table > tbody > tr > td:nth-child(6) {
            width: 80px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(7),
        .tilsoft-table-filter > div:nth-child(7),
        .tilsoft-table-body table > tbody > tr > td:nth-child(7) {
            width: 70px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(8),
        .tilsoft-table-filter > div:nth-child(8),
        .tilsoft-table-body table > tbody > tr > td:nth-child(8) {
            width: 90px;
            text-align: center;
        }

        .tilsoft-table-header > div:nth-child(9),
        .tilsoft-table-filter > div:nth-child(9),
        .tilsoft-table-body table > tbody > tr > td:nth-child(9) {
            width: 90px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(10),
        .tilsoft-table-filter > div:nth-child(10),
        .tilsoft-table-body table > tbody > tr > td:nth-child(10) {
            width: 70px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(11),
        .tilsoft-table-filter > div:nth-child(11),
        .tilsoft-table-body table > tbody > tr > td:nth-child(11) {
            width: 80px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(12),
        .tilsoft-table-filter > div:nth-child(12),
        .tilsoft-table-body table > tbody > tr > td:nth-child(12) {
            width: 120px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(13),
        .tilsoft-table-filter > div:nth-child(13),
        .tilsoft-table-body table > tbody > tr > td:nth-child(13) {
            width: 80px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(14),
        .tilsoft-table-filter > div:nth-child(14),
        .tilsoft-table-body table > tbody > tr > td:nth-child(14) {
            width: 105px;
            text-align: center;
        }
        /*Status column*/
        .tilsoft-table-header > div:nth-child(15),
        .tilsoft-table-filter > div:nth-child(15),
        .tilsoft-table-body table > tbody > tr > td:nth-child(15) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(16),
        .tilsoft-table-filter > div:nth-child(16),
        .tilsoft-table-body table > tbody > tr > td:nth-child(16) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(17),
        .tilsoft-table-filter > div:nth-child(17),
        .tilsoft-table-body table > tbody > tr > td:nth-child(17) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(18),
        .tilsoft-table-filter > div:nth-child(18),
        .tilsoft-table-body table > tbody > tr > td:nth-child(18) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(19),
        .tilsoft-table-filter > div:nth-child(19),
        .tilsoft-table-body table > tbody > tr > td:nth-child(19) {
            width: 100px;
            text-align: center;
        }
        .tilsoft-table-header > div:nth-child(20),
        .tilsoft-table-filter > div:nth-child(20),
        .tilsoft-table-body table > tbody > tr > td:nth-child(20) {
            width: 100px;
            text-align: center;
        }
</style>
<style>
    .OK {
        background-color: #33cc33;
    }

    .DO {
        background-color: #00b0f0;
    }

    .NOT {
        background-color: #aeaaaa;
    }

    .NO {
        background-color: yellow;
    }

    .OVER {
        background-color: red;
    }
</style>
<div class="row" ng-show="currentScreen==screen._WORKORDER">
    <article class="col-sm-12">
        <div class="jarviswidget">
            <header>
                <span class="widget-icon"> <i class="fa fa-filter txt-color-darken"></i> </span>
                <h2>Filter</h2>
            </header>
            <div>
                <div class="widget-body no-padding">
                    <div class="smart-form">
                        <fieldset>
                            <div class="row">
                                <section class="col col-3">
                                    <label class="label">Start Date From</label>
                                    <label class="input">
                                        <input type="text" class="datepicker search-filter" ng-model="filters.StartDateFrom" data-dateformat="dd/mm/yy" />
                                        <i class="icon-append fa fa-calendar"></i>
                                    </label>
                                </section>
                                <section class="col col-3">
                                    <label class="label">Start Date To</label>
                                    <label class="input">
                                        <input type="text" class="datepicker search-filter" ng-model="filters.StartDateTo" data-dateformat="dd/mm/yy" />
                                        <i class="icon-append fa fa-calendar"></i>
                                    </label>
                                </section>
                                <section class="col col-3">
                                    <label class="label">Finished Date From</label>
                                    <label class="input">
                                        <input type="text" class="datepicker search-filter" ng-model="filters.FinishedDateFrom" data-dateformat="dd/mm/yy" />
                                        <i class="icon-append fa fa-calendar"></i>
                                    </label>
                                </section>
                                <section class="col col-3">
                                    <label class="label">Finished Date To</label>
                                    <label class="input">
                                        <input type="text" class="datepicker search-filter" ng-model="filters.FinishedDateTo" data-dateformat="dd/mm/yy" />
                                        <i class="icon-append fa fa-calendar"></i>
                                    </label>
                                </section>
                            </div>
                            <div class="row">
                                <section class="col col-3">
                                    <label class="label">Work Order</label>
                                    <label class="input">
                                        <input type="text" class="search-filter" ng-model="filters.WorkOrderUD" />
                                    </label>
                                </section>

                                <section class="col col-3">
                                    <label class="label">Work Center</label>
                                    <label class="select">
                                        <select class="search-filter" required ng-model="filters.WorkCenterID" ng-options="center.workCenterID as center.workCenterNM for center in workCenters">
                                            <option value="7"></option>
                                        </select>
                                        <i></i>
                                    </label>
                                </section>
                                <section class="col col-3">
                                    <label class="label">Client</label>
                                    <label class="input">
                                        <input type="text" class="search-filter" ng-model="filters.ClientUD" />
                                    </label>
                                </section>
                                @*<section class="col col-2">
                                        <label class="label">P/I</label>
                                        <label class="input">
                                            <input type="text" class="search-filter" ng-model="filters.ProformaInvoiceNo" />
                                        </label>
                                    </section>*@
                                <section class="col col-3">
                                    <label class="label">Status</label>
                                    <label class="select">
                                        <select class="search-filter" ng-model="filters.WorkOrderStatus" ng-options="status as status for status in statuses">
                                            <option></option>
                                        </select>
                                        <i></i>
                                    </label>
                                </section>
                            </div>

                        </fieldset>
                        <footer>
                            <a href="javascript:void(0)" class="btn btn-primary" ng-click="event.search()" style="float: none;"><i class="fa fa-bar-chart-o"></i> Generate</a>
                            <a href="javascript:void(0)" class="btn btn-default" ng-click="event.reload()" style="float: none;"><i class="fa fa-refresh"></i> Refresh</a>
                        </footer>
                    </div>
                </div>
            </div>
        </div>
    </article>

    <article class="col-sm-12">
        <div class="jarviswidget">
            <div class="no-padding">
                <div class="widget-body" style="padding-bottom: 0px;">
                    <div avs-scrollable-table class="tilsoft-table-wrapper">
                        <div class="tilsoft-table">
                            <div class="tilsoft-table-header" style="width: {{1945 + weekInfo.length*110 + 20}}px;">
                                <div style="width:100px">Work Order</div>
                                <div style="width:80px">Order NO.</div>
                                <div style="width:80px">Client</div>
                                <div style="width:100px">Picture</div>
                                <div style="width:200px">Art. Description</div>
                                <div style="width:80px">QNT/40FT</div>
                                <div style="width:70px">Order Qnt</div>
                                <div style="width:90px">Product ion Qnt</div>
                                <div style="width:90px">Remain</div>
                                <div style="width:70px">Order Cont</div>
                                <div style="width:80px">Kind of Item</div>
                                <div style="width:120px">LDS</div>
                                <div style="width:80px">Duration</div>
                                <div style="width:105px">Grant Chart</div>
                                @* Status column *@

                                <div class="no-padding" style="width: 600px; height: 100%; text-align: center; background-color: #eee">
                                    <div class="no-padding" style="width: 100%; height:50%; border-right: none; line-height: 30px">Status production</div>
                                    <div class="no-padding" style="width: 100%; height: 50%; border-right: none; line-height: 30px">
                                        <div class="no-padding" style="width: 100px; text-align: center; height: 100%; line-height: 40px">Frame</div>
                                        <div class="no-padding" style="width: 100px; text-align: center; height: 100%; line-height: 40px">Weaving</div>
                                        <div class="no-padding" style="width: 100px; text-align: center; height: 100%; line-height: 40px">Cushion</div>
                                        <div class="no-padding" style="width: 100px; text-align: center; height: 100%; line-height: 40px">Wood part</div>
                                        <div class="no-padding" style="width: 100px; text-align: center; height: 100%; line-height: 40px">Carton box</div>
                                        <div class="no-padding" style="text-align: center; height: 100%; line-height: 40px">Packing</div>
                                    </div>
                                </div>

                                <div class="no-padding" ng-repeat="wItem in weekInfo" style="padding:unset; width: 110px; height: 70px; text-align: center;">
                                    W{{wItem.weekIndex}}<br /><span class="note">{{wItem.weekStart}}<br />{{wItem.weekEnd}}</span>
                                    <div style="padding:unset; width: 55px; text-align: center; height:26px">Plan</div>
                                    <div style="padding:unset; text-align: center; height:26px">Real</div>
                                </div>
                                <div>&nbsp;</div>
                            </div>
                            <div class="tilsoft-table-body" style="width:{{1945 + weekInfo.length*110 + 20}}px;">
                                <table>
                                    <tbody ng-repeat="item in data">
                                        <tr>
                                            <td style="width:100px">
                                                <a target="_blank" href="@Url.Action("Edit", "WorkOrder", new {id= UrlParameter.Optional})/{{item.workOrderID}}" ng-if="'@(Frontend.Helper.AuthHelper.GetActionButtonStatus("WorkOrderMng", Frontend.Helper.ActionEnum.Create, HttpContext.Current))' !== 'disabled'">{{item.workOrderUD}}</a>
                                                @*<span ng-if="'@(Frontend.Helper.AuthHelper.GetActionButtonStatus("WorkOrderMng", Frontend.Helper.ActionEnum.Create, HttpContext.Current))' === 'disabled'">{{item.workOrderUD}}</span>*@
                                                <a class="btn btn-primary btn-xs font-11" title="View set detail" ng-show="item.pieceQnt>1" ng-click="showSetDetail($event,item.workOrderID)"><i id="icon-view-pi-{{item.workOrderID}}" class="fa fa-plus-square-o"></i> View Detail</a>
                                            </td>
                                            <td style="width:80px">{{item.proformaInvoiceNo}}</td>
                                            <td style="width:80px">{{item.clientUD}}</td>
                                            <td style="width: 100px; text-align: center; vertical-align: middle;">
                                                <a href="{{item.fileLocation}}" data-featherlight="image">
                                                    <img style="width: 50%;" ng-src="{{item.thumbnailLocation}}" />
                                                </a>
                                            </td>
                                            <td style="width:200px">{{item.modelNM}}</td>
                                            <td style="width:80px">{{item.qnt40HC}}</td>
                                            <td style="width:70px">{{item.quantity}}</td>
                                            <td style="width:90px">{{method.getProductQuantity(item)}}</td>
                                            <td style="width:90px">{{item.remain}}</td>
                                            <td style="width:70px">{{item.quantity/item.qnt40HC | number:2}}</td>
                                            <td style="width:80px"></td>
                                            <td style="width:120px">{{item.lds| date : 'dd/MM/yyyy'}}</td>
                                            <td style="width:80px">{{item.duration}}</td>
                                            <td style="width:105px">
                                                <a class="btn btn-warning btn-xs" href="@Url.Action("GrantChart", "PlanningProductionMng")/{{item.planningProductionGrantChartID}}" title="Edit" target="_blank" style="width:95%" ng-disabled="item.planningProductionGrantChartID==0"><i class="fa fa-bar-chart-o"></i> Grant Chart</a>
                                            </td>
                                            <td style="width:100px" class="{{method.checkWorkCenterStatus(item,7)}}">{{item.frameStatus}}</td>
                                            <td style="width:100px" class="{{method.checkWorkCenterStatus(item,9)}}">{{item.weavingStatus}}</td>
                                            <td style="width:100px" class="{{method.checkMaterialStatus(item,18)}}">{{item.cushionStatus}}</td>
                                            <td style="width:100px" class="{{method.checkMaterialStatus(item,15)}}">{{item.woodStatus}}</td>
                                            <td style="width:100px" class="{{method.checkMaterialStatus(item,17)}}">{{item.cartonStatus}}</td>
                                            <td style="width:100px" class="{{method.checkWorkCenterStatus(item,11)}}">{{item.packingStatus}}</td>
                                            <td style="text-align:right; width:55px;" ng-repeat="dItem in weekInfo_x2">
                                                <div style="width: 100%;text-align: right" ng-if="dItem.colName == 'Plan' && dItem.weekInfoID == item.weekInfoID">
                                                    {{item.planQnt}}
                                                </div>
                                                <div style="width: 100%;text-align: right" ng-if="dItem.colName == 'Real'">
                                                    {{method.getRealQnt(item.workOrderID, dItem.weekInfoID)}}
                                                </div>
                                            </td>
                                            <td style="border-bottom: none !important; border-right:unset"></td>
                                        </tr>
                                        <tr class="{{item.workOrderID}}" style="display:none; background-color:#ecf3f8" ng-show="item.pieceQnt>1" ng-if="setItem.workOrderID == item.workOrderID" ng-repeat="setItem in ReceivingSetDetail">
                                            <td colspan="20">
                                                {{setItem.productionItemNM}}
                                            </td>

                                            <td style="text-align:right; width:55px;" ng-repeat="dItem in weekInfo_x2">
                                                <div style="width: 100%;text-align: right" ng-if="dItem.colName == 'Real' && setItem.weekInfoID == dItem.weekInfoID">
                                                    {{setItem.totalReceiving}}
                                                </div>
                                            </td>
                                            <td style="border-bottom: none !important; border-right:unset"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>





</div>

<div class="row" ng-show="currentScreen==screen._WORKORDER_DETAIL">

    <article class="col-sm-12">
        <div class="jarviswidget">
            <div>
                <div class="widget-body no-padding">
                    <div class="smart-form">
                        <footer>
                            <a href="javascript:void(0)" class="btn btn-primary" ng-click="workOrderDetailSreen.close()"><i class="fa fa-arrow-left"></i> Back</a>
                        </footer>
                        <section class="col col-lg-12">
                            <div avs-scrollable-table class="tilsoft-table-wrapper">
                                <div class="tilsoft-table">
                                    <div class="tilsoft-table-header">
                                        <div style="width:100px">WorkCenter</div>
                                        <div style="width:80px">% Complete</div>
                                        <div style="width:150px">Team</div>
                                        <div style="width:350px">Item Code</div>
                                        <div style="width:500px">Item Name</div>
                                        <div style="width:100px">Plan</div>
                                        <div style="width:100px">Received</div>
                                        <div style="width:100px">Produced</div>
                                        <div style="width:100px">Remain</div>
                                        <div>&nbsp;</div>
                                    </div>
                                    <div class="tilsoft-table-body">
                                        <table>
                                            <tr ng-repeat="item in workOrderDetailSreen.data">
                                                <td style="width:99px ;text-align:left">{{item.workCenterNM}}</td>
                                                <td style="width:80px ;text-align:right">{{item.producedQnt * 100 /item.normQnt | number : 2}} %</td>
                                                <td style="width:150px ;text-align:left">{{item.productionTeamNM}}</td>
                                                <td style="width:350px ;text-align:left">{{item.productionItemUD}}</td>
                                                <td style="width:500px ;text-align:left">{{item.productionItemNM}}</td>
                                                <td style="width:100px ;text-align:right">{{item.normQnt | number : 2}}</td>
                                                <td style="width:100px ;text-align:right">{{item.receivedQnt | number : 2}}</td>
                                                <td style="width:100px ;text-align:right">{{item.producedQnt | number : 2}}</td>
                                                <td style="width:100px ;text-align:right">{{item.remainQnt | number : 2}}</td>
                                                <td></td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>
    </article>

</div>

@section FormAction {
    <ul id="sparks"></ul>
}

@section pagejs {
    <script type="text/javascript">
        var context = {
            serviceUrl: '@(System.Configuration.ConfigurationManager.AppSettings["BackendServiceUrl"])api/planningreportworkcenter/',
            token : '@Session[Frontend.Customize.Common.ProjectDefinition.TOKEN_SESSION]',
            pageSize: 50
        }
    </script>
    <script src="~/Views/PlanningReportWorkcenter/index.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Angular/app/jsonService2.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
    <script src="~/Views/PlanningReportWorkcenter/service.js?c=@System.Guid.NewGuid().ToString().Replace("-", "")"></script>
}
