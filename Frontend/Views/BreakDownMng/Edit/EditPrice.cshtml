@using Frontend.Helper;

<form class="row" name="frmEditPrice" id="frmEditPrice" style="display: none;">
    <article class="col-sm-12 col-md-12 col-lg-12">
        <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false" data-widget-colorbutton="false" data-widget-fullscreenbutton="false" data-widget-deletebutton="false">
            <header>
                <span class="widget-icon"> <i class="fa fa-dollar txt-color-darken"></i> </span>
                <h2>Edit Price List</h2>
            </header>
            <div>
                <div class="widget-body no-padding">
                    <div class="smart-form">
                        <fieldset>
                            <section>
                                <table class="table table-bordered table-striped">
                                    <tr>
                                        <th>Item Description</th>
                                    </tr>
                                    <tr ng-if="data.modelID">
                                        <td>
                                            <a href="javascript:void(0)">{{data.modelUD}}</a>
                                            <br />
                                            {{data.modelNM}}
                                        </td>
                                    </tr>
                                    <tr ng-if="data.sampleProductId">
                                        <td>
                                            <a href="javascript:void(0)">{{data.sampleProductUD}}</a>
                                            <br />
                                            {{data.articleDescription}}
                                        </td>
                                    </tr>
                                </table>
                            </section>                          
                            <div class="widget-footer" style="padding: 10px;">
                                <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="frmEditPriceObj.event.save()"><i class="fa fa-plus"></i> Set Price</a>
                                <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="frmEditPriceObj.event.getPriceQuotation()"><i class="fa fa-pencil"></i> Update Price From Quotation</a>
                                <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="frmEditPriceObj.event.close()"><i class="fa fa-times"></i> Close</a>
                            </div>
                            <section>
                                <div class="tilsoft-table-wrapper" avs-scrollable-table>
                                    <div class="tilsoft-table">
                                        <div class="tilsoft-table-header" style="width:3000px">
                                            <div style="width:300px; height:60px;">Item Name (VN)</div>
                                            <div style="width:300px; height:60px;">Item Name (EN)</div>
                                            <div style="width:100px; height:60px;">Unit</div>

                                            <div ng-if="companyId===3" class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">PAL Price</div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>

                                            <div class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">Current Price (VND)</div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>

                                            <div ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">{{frmEditPriceObj.data.breakdownPriceHistoryDTOs[0].breakdownPriceHistoryUD}} (VND) </div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>

                                            <div ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">Delta</div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>

                                            <div ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1 " class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">{{frmEditPriceObj.data.breakdownPriceHistoryDTOs[1].breakdownPriceHistoryUD}} (VND) </div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>

                                            <div ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2 " class="no-padding" style="width:300px; height:60px;">
                                                <div class="no-padding" style="width:100%; height:30px; border-right:none; line-height:30px;">{{frmEditPriceObj.data.breakdownPriceHistoryDTOs[2].breakdownPriceHistoryUD}} (VND) </div>
                                                <div class="no-padding" style="width:100%; height:30px;">
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">QNT</div>
                                                    <div class="no-padding" style="width:100px; height:30px; line-height:30px;">Price</div>
                                                    <div class="no-padding" style="width:100%; height:30px; line-height:30px;">Amount</div>
                                                </div>
                                            </div>
                                            <div style="border-bottom:none; height:60px;"></div>
                                        </div>
                                        <div class="tilsoft-table-body" style="width:3000px; margin-top: 60px;">
                                            <table>
                                                <tr>
                                                    <td colspan="2" style="width: 600px;"></td>
                                                    <td style="width: 100px;"></td>

                                                    <td ng-if="companyId===3" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="companyId===3" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="companyId===3" style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPriceAVF() | number : 0}}</b></td>

                                                    <td style="width: 100px;text-align: right;"></td>
                                                    <td style="width: 100px;text-align: right;"></td>
                                                    <td style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPrice() | number : 0}}</b></td>

                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPrice1() | number : 0}}</b></td>

                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPrice() - method.getTotalAmountSumPrice1() | number : 0}}</b></td>

                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPrice2() | number : 0}}</b></td>

                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;"></td>
                                                    <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;"><b>{{method.getTotalAmountSumPrice3() | number : 0}}</b></td>

                                                    <td style="border-bottom: none;"></td>
                                                </tr>
                                                <tbody ng-repeat="itemBreakDownBreakdownCategoryDTOs in frmEditPriceObj.data.breakDownBreakdownCategoryDTOs">
                                                    <tr style="background: #fbd8d5">
                                                        <td colspan="2" style="width: 600px;">
                                                            <b> {{itemBreakDownBreakdownCategoryDTOs.breakdownCategoryNM}} : {{itemBreakDownBreakdownCategoryDTOs.optionName }} </b>
                                                        </td>
                                                        <td style="width: 100px;"></td>

                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;">{{method.getTotalAmountPrice1(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td style="width: 100px;text-align: right;"></td>
                                                        <td style="width: 100px;text-align: right;"></td>
                                                        <td style="width: 100px;text-align: right;">{{method.getTotalAmountPrice(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{method.getTotalAmountPrice1(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{method.getTotalAmountPrice(itemBreakDownBreakdownCategoryDTOs) - method.getTotalAmountPrice1(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;">{{method.getTotalAmountPrice2(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;"></td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;">{{method.getTotalAmountPrice3(itemBreakDownBreakdownCategoryDTOs) | number : 0}}</td>

                                                        <td style="border-bottom: none;"></td>
                                                    </tr>
                                                    <tr style="background: #ecffff" ng-repeat="item in itemBreakDownBreakdownCategoryDTOs.breakDownPriceDefaultDTOs">
                                                        <td style="width: 300px;">{{item.productionItemVNNM}}</td>
                                                        <td style="width: 300px;">{{item.productionItemNM}}</td>
                                                        <td style="width: 100px;">{{item.unitNM}}</td>

                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;">{{item.quantityAVF | number:2}}</td>
                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;">{{item.unitPriceAVF | number:2}}</td>
                                                        <td ng-if="companyId===3" style="width: 100px;text-align: right;">{{item.quantityAVF * item.unitPriceAVF | number:2}}</td>

                                                        <td style="width: 100px;text-align: right;">{{item.quantity | number:2}}</td>
                                                        <td style="width: 100px;text-align: right;">
                                                            <input type="text" ng-model="item.unitPrice" avs-number-2 ng-decimal="0" style="text-align: right; width: 100%; box-sizing: border-box; padding: 2px;" />
                                                        </td>
                                                        <td style="width: 100px;text-align: right;">{{item.quantity * item.unitPrice | number:2}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{item.quantity1 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{item.unitPrice1 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{item.quantity1 * item.unitPrice1 | number:2}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{item.quantity - item.quantity1 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{item.unitPrice - item.unitPrice1 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 0" style="width: 100px;text-align: right;">{{(item.quantity - item.quantity1) * (item.unitPrice - item.unitPrice1) | number:2}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;">{{item.quantity2 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;">{{item.unitPrice2 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 1" style="width: 100px;text-align: right;">{{item.quantity2 * item.unitPrice2 | number:2}}</td>

                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;">{{item.quantity3 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;">{{item.unitPrice3 | number:2}}</td>
                                                        <td ng-if="frmEditPriceObj.data.breakdownPriceHistoryDTOs.length > 2" style="width: 100px;text-align: right;">{{item.quantity3 * item.unitPrice3 | number:2}}</td>

                                                        <td style="border-bottom: none;"></td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        </fieldset>
                    </div>
                    <div class="widget-footer" style="padding: 10px;">                        
                        <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="frmEditPriceObj.event.save()"><i class="fa fa-plus"></i> Set Price</a>
                        <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="frmEditPriceObj.event.getPriceQuotation()"><i class="fa fa-pencil"></i> Update Price From Quotation</a>
                        <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="frmEditPriceObj.event.close()"><i class="fa fa-times"></i> Close</a>
                    </div>
                </div>
                @*<div class="widget-body no-padding">
            <div class="smart-form">
                <fieldset>
                    <section>
                        <table class="table table-bordered table-striped">
                            <tr>
                                <th>Item Description</th>
                            </tr>
                            <tr ng-if="data.modelID">
                                <td>
                                    <a href="javascript:void(0)">{{data.modelUD}}</a>
                                    <br />
                                    {{data.modelNM}}
                                </td>
                            </tr>
                            <tr ng-if="data.sampleProductId">
                                <td>
                                    <a href="javascript:void(0)">{{data.sampleProductUD}}</a>
                                    <br />
                                    {{data.articleDescription}}
                                </td>
                            </tr>
                        </table>
                    </section>
                    <section>
                        <table class="table table-bordered table-striped">
                            <thead>
                                <tr>
                                    <th rowspan="3" style="text-align: center;">Item Name (VN)</th>
                                    <th rowspan="3" style="text-align: center;">Item Name (EN)</th>
                                    <th rowspan="3" style="text-align: center;">Unit</th>
                                    <th colspan="4" style="text-align: center;">U.Price</th>
                                </tr>
                                <tr>
                                    <th colspan="2" style="text-align: center;">VND</th>
                                    <th colspan="2" style="text-align: center;">USD</th>
                                </tr>
                                <tr>
                                    <th style="text-align: center; width: 100px;">AVF</th>
                                    <th ng-if="companyId === 1"></th>
                                    <th style="text-align: center; width: 100px;" ng-if="companyId === 3">AVT</th>
                                    <th style="text-align: center; width: 60px;">AVF</th>
                                    <th ng-if="companyId === 1"></th>
                                    <th style="text-align: center; width: 60px;" ng-if="companyId === 3">AVT</th>
                                </tr>
                            </thead>
                            <tr ng-repeat="item in frmEditPriceObj.data">
                                <td>{{item.itemNameVN}}</td>
                                <td>{{item.itemNameEN}}</td>
                                <td style="text-align: center;">{{item.unitNM}}</td>
                                <td style="text-align: right;">
                                    <input ng-if="frmEditPriceObj.companyId === 1" type="text" ng-model="item.avfPrice" avs-number-2 ng-decimal="0" style="text-align: right; width: 100%; box-sizing: border-box; padding: 2px;" />
                                    <span ng-if="frmEditPriceObj.companyId !== 1">{{item.avfPrice | number:2}}</span>
                                </td>

                                <td ng-if="companyId === 1"></td>
                                <td style="text-align: right;" ng-if="companyId === 3">
                                    <input ng-if="frmEditPriceObj.companyId !== 1" type="text" ng-model="item.avtPrice" avs-number-2 ng-decimal="0" style="text-align: right; width: 100%; box-sizing: border-box; padding: 2px;" />
                                    <span ng-if="frmEditPriceObj.companyId === 1">{{item.avtPrice | number:2}}</span>
                                </td>
                                <td style="text-align: right;">{{item.avfPrice / exRate | currency:'$':2}}</td>

                                <td ng-if="companyId === 1"></td>
                                <td style="text-align: right;" ng-if="companyId === 3">{{item.avtPrice / exRate | currency:'$':2}}</td>
                            </tr>
                        </table>
                    </section>
                </fieldset>
            </div>
            <div class="widget-footer" style="padding: 10px;">
                <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-if="companyId === 1" ng-click="frmEditPriceObj.event.updatePrice()"><i class="fa fa-pencil"></i> Get Price from Purchasing</a>
                <a href="javascript:void(0)" class="btn btn-primary btn-sm" ng-click="frmEditPriceObj.event.save()"><i class="fa fa-plus"></i> Save</a>
                <a href="javascript:void(0)" class="btn btn-default btn-sm" ng-click="frmEditPriceObj.event.close()"><i class="fa fa-times"></i> Close</a>
            </div>
        </div>*@
            </div>
        </div>
    </article>
</form>